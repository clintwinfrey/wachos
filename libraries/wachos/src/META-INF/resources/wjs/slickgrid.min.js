/**
 * @license
 * (c) 2009-2016 Michael Leibman
 * michael{dot}leibman{at}gmail{dot}com
 * http://github.com/mleibman/slickgrid
 *
 * Distributed under MIT license.
 * All rights reserved.
 *
 * SlickGrid v3.0.2
 *
 * NOTES:
 *     Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods.
 *     This increases the speed dramatically, but can only be done safely because there are no event handlers
 *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
 *     and do proper cleanup.
 */
if(function(e){function o(){var e=!1,o=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){o=!0},this.isImmediatePropagationStopped=function(){return o}}function t(){this.__nonDataRow=!0}function n(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function l(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function r(){var e=null;this.isActive=function(o){return o?e===o:null!==e},this.activate=function(o){if(o!==e){if(null!==e)throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController");if(!o.commitCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!o.cancelCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()");e=o}},this.deactivate=function(o){if(e){if(e!==o)throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one");e=null}},this.commitCurrentEdit=function(){return!e||e.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!e||e.cancelCurrentEdit()}}n.prototype=new t,n.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},l.prototype=new t;var i="Map"in window?window.Map:function(){var e={};this.get=function(o){return e[o]},this.set=function(o,t){e[o]=t},this.has=function(o){return o in e},this.delete=function(o){delete e[o]}};e.extend(!0,window,{Slick:{Event:function(){var e=[];this.subscribe=function(o){e.push(o)},this.unsubscribe=function(o){for(var t=e.length-1;t>=0;t--)e[t]===o&&e.splice(t,1)},this.notify=function(t,n,l){var r;n=n||new o,l=l||this;for(var i=0;i<e.length&&!n.isPropagationStopped()&&!n.isImmediatePropagationStopped();i++)r=e[i].call(l,n,t);return r}},EventData:o,EventHandler:function(){var e=[];this.subscribe=function(o,t){return e.push({event:o,handler:t}),o.subscribe(t),this},this.unsubscribe=function(o,t){for(var n=e.length;n--;)if(e[n].event===o&&e[n].handler===t)return e.splice(n,1),void o.unsubscribe(t);return this},this.unsubscribeAll=function(){for(var o=e.length;o--;)e[o].event.unsubscribe(e[o].handler);return e=[],this}},Range:function(e,o,t,n){void 0===t&&void 0===n&&(t=e,n=o),this.fromRow=Math.min(e,t),this.fromCell=Math.min(o,n),this.toRow=Math.max(e,t),this.toCell=Math.max(o,n),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,o){return e>=this.fromRow&&e<=this.toRow&&o>=this.fromCell&&o<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}},Map:i,NonDataRow:t,Group:n,GroupTotals:l,RegexSanitizer:function(e){return e.replace(/(\b)(on[a-z]+)(\s*)=|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;)(\/*)(script|script defer)(.*)(&gt;|&gt;">)/gi,"")},EditorLock:r,GlobalEditorLock:new r,TreeColumns:function(o){var t={};function n(e){e.forEach((function(e){t[e.id]=e,e.columns&&n(e.columns)}))}function l(e,o){return e.filter((function(e){var t=o.call(e);return t&&e.columns&&(e.columns=l(e.columns,o)),t&&(!e.columns||e.columns.length)}))}function r(e,o){e.sort((function(e,t){return i(o.getColumnIndex(e.id))-i(o.getColumnIndex(t.id))})).forEach((function(e){e.columns&&r(e.columns,o)}))}function i(e){return void 0===e?-1:e}function a(e){if(!e.length)return e.columns?1+a(e.columns):1;for(var o in e)return a(e[o])}function s(e,o,t){var n=[];if(o==(t=t||0))return e.length&&e.forEach((function(e){e.columns&&(e.extractColumns=function(){return c(e)})})),e;for(var l in e)e[l].columns&&(n=n.concat(s(e[l].columns,o,t+1)));return n}function c(e){var o=[];if(e.hasOwnProperty("length"))for(var t=0;t<e.length;t++)o=o.concat(c(e[t]));else{if(!e.hasOwnProperty("columns"))return e;o=o.concat(c(e.columns))}return o}function d(){return e.extend(!0,[],o)}n(o),this.hasDepth=function(){for(var e in o)if(o[e].hasOwnProperty("columns"))return!0;return!1},this.getTreeColumns=function(){return o},this.extractColumns=function(){return this.hasDepth()?c(o):o},this.getDepth=function(){return a(o)},this.getColumnsInDepth=function(e){return s(o,e)},this.getColumnsInGroup=function(e){return c(e)},this.visibleColumns=function(){return l(d(),(function(){return this.visible}))},this.filter=function(e){return l(d(),e)},this.reOrder=function(e){return r(o,e)},this.getById=function(e){return t[e]},this.getInIds=function(e){return e.map((function(e){return t[e]}))}},keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentExpandOnly:"CXO",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{Auto:"AUTO",TextOnly:"CANV",HTML:"HTML"}}})}(jQuery),function(e){e.extend(!0,window,{Slick:{AutoTooltips:function(o){var t,n={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:null,replaceExisting:!0};function l(n){var l=t.getCellFromEvent(n);if(l){var r,i=e(t.getCellNode(l.row,l.cell));i.attr("title")&&!o.replaceExisting||(i.innerWidth()<i[0].scrollWidth?(r=e.trim(i.text()),o.maxToolTipLength&&r.length>o.maxToolTipLength&&(r=r.substr(0,o.maxToolTipLength-3)+"...")):r="",i.attr("title",r)),i=null}}function r(o,t){var n=t.column,l=e(o.target).closest(".slick-header-column");n&&!n.toolTip&&l.attr("title",l.innerWidth()<l[0].scrollWidth?n.name:""),l=null}e.extend(this,{init:function(i){o=e.extend(!0,{},n,o),t=i,o.enableForCells&&t.onMouseEnter.subscribe(l),o.enableForHeaderCells&&t.onHeaderMouseEnter.subscribe(r)},destroy:function(){o.enableForCells&&t.onMouseEnter.unsubscribe(l),o.enableForHeaderCells&&t.onHeaderMouseEnter.unsubscribe(r)},pluginName:"AutoTooltips"})}}})}(jQuery),function(e){e.extend(!0,window,{Slick:{CellExternalCopyManager:function(o){var t,n,l=this,r=o||{},i=r.copiedCellStyleLayerKey||"copy-manager",a=r.copiedCellStyle||"copied",s=0,c=r.bodyElement||document.body,d=r.onCopyInit||null,u=r.onCopySuccess||null,h={C:67,V:86,ESC:27,INSERT:45};function p(e){if(r.headerColumnValueExtractor){var o=r.headerColumnValueExtractor(e);if(o)return o}return e.name}function f(o,n,l){if(r.dataItemColumnValueExtractor){var i=r.dataItemColumnValueExtractor(o,n);if(i)return i}var a="";if(n.editor){var s={container:e("<p>"),column:n,position:{top:0,left:0},grid:t,event:l},c=new n.editor(s);c.loadValue(o),a=c.serializeValue(),c.destroy()}else a=o[n.field];return a}function m(o,n,l){if(n.denyPaste)return null;if(r.dataItemColumnValueSetter)return r.dataItemColumnValueSetter(o,n,l);if(n.editor){var i={container:e("body"),column:n,position:{top:0,left:0},grid:t},a=new n.editor(i);a.loadValue(o),a.applyValue(o,l),a.destroy()}else o[n.field]=l}function g(e){var o=document.createElement("textarea");return o.style.position="absolute",o.style.left="-1000px",o.style.top=document.body.scrollTop+"px",o.value=e,c.appendChild(o),o.select(),o}function v(e,o){var i;if(!t.getEditorLock().isActive()||t.getOptions().autoEdit){if(e.which==h.ESC&&n&&(e.preventDefault(),C(),l.onCopyCancelled.notify({ranges:n}),n=null),(e.which===h.C||e.which===h.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(d&&d.call(),0!==(i=t.getSelectionModel().getSelectedRanges()).length)){n=i,w(i),l.onCopyCells.notify({ranges:i});for(var a=t.getColumns(),s="",v=0;v<i.length;v++){for(var R=i[v],S=[],$=R.fromRow;$<R.toRow+1;$++){var y=[],b=t.getDataItem($);if(0===S.length&&r.includeHeaderWhenCopying){for(var z=[],L=R.fromCell;L<R.toCell+1;L++)a[L].name.length>0&&z.push(p(a[L]));S.push(z.join("\t"))}for(L=R.fromCell;L<R.toCell+1;L++)y.push(f(b,a[L],e));S.push(y.join("\t"))}s+=S.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",s),!0;var P=document.activeElement;if((x=g(s)).focus(),setTimeout((function(){c.removeChild(x),P?P.focus():console.log("Not element to restore focus to after copy?")}),100),u){var k=0;k=1===i.length?i[0].toRow+1-i[0].fromRow:i.length,u.call(this,k)}return!1}if(!r.readOnlyMode&&(e.which===h.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===h.INSERT&&e.shiftKey&&!e.ctrlKey)){var x=g("");return setTimeout((function(){!function(e,o){var t=e.getColumns(),n=o.value.split(/[\n\f\r]/);""===n[n.length-1]&&n.pop();var i=[],a=0;c.removeChild(o);for(var s=0;s<n.length;s++)""!==n[s]?i[a++]=n[s].split("\t"):i[a++]=[""];var d=e.getActiveCell(),u=e.getSelectionModel().getSelectedRanges(),h=u&&u.length?u[0]:null,p=null,f=null;if(h)p=h.fromRow,f=h.fromCell;else{if(!d)return;p=d.row,f=d.cell}var g=!1,v=i.length,C=i.length?i[0].length:0;1==i.length&&1==i[0].length&&h&&(g=!0,v=h.toRow-h.fromRow+1,C=h.toCell-h.fromCell+1);var R=e.getData().length-p,S=0;if(R<v&&r.newRowCreator){var $=e.getData();for(S=1;S<=v-R;S++)$.push({});e.setData($),e.render()}var y=p+v>e.getDataLength();if(r.newRowCreator&&y){var b=p+v-e.getDataLength();r.newRowCreator(b)}var z={isClipboardCommand:!0,clippedRange:i,oldValues:[],cellExternalCopyManager:l,_options:r,setDataItemValueForColumn:m,markCopySelection:w,oneCellToMultiple:g,activeRow:p,activeCell:f,destH:v,destW:C,maxDestY:e.getDataLength(),maxDestX:e.getColumns().length,h:0,w:0,execute:function(){this.h=0;for(var o=0;o<this.destH;o++){this.oldValues[o]=[],this.w=0,this.h++;for(var n=0;n<this.destW;n++){this.w++;var l=p+o,r=f+n;if(l<this.maxDestY&&r<this.maxDestX){e.getCellNode(l,r);var a=e.getDataItem(l);this.oldValues[o][n]=a[t[r].field],g?this.setDataItemValueForColumn(a,t[r],i[0][0]):this.setDataItemValueForColumn(a,t[r],i[o]?i[o][n]:""),e.updateCell(l,r),e.onCellChange.notify({row:l,cell:r,item:a,grid:e})}}}var s={fromCell:f,fromRow:p,toCell:f+this.w-1,toRow:p+this.h-1};this.markCopySelection([s]),e.getSelectionModel().setSelectedRanges([s]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[s]})},undo:function(){for(var o=0;o<this.destH;o++)for(var n=0;n<this.destW;n++){var l=p+o,r=f+n;if(l<this.maxDestY&&r<this.maxDestX){e.getCellNode(l,r);var i=e.getDataItem(l);g?this.setDataItemValueForColumn(i,t[r],this.oldValues[0][0]):this.setDataItemValueForColumn(i,t[r],this.oldValues[o][n]),e.updateCell(l,r),e.onCellChange.notify({row:l,cell:r,item:i,grid:e})}}var a={fromCell:f,fromRow:p,toCell:f+this.w-1,toRow:p+this.h-1};if(this.markCopySelection([a]),e.getSelectionModel().setSelectedRanges([a]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[a]}),S>1){for(var s=e.getData();S>1;S--)s.splice(s.length-1,1);e.setData(s),e.render()}}};r.clipboardCommandHandler?r.clipboardCommandHandler(z):z.execute()}(t,x)}),100),!1}}}function w(e){C();for(var o=t.getColumns(),n={},r=0;r<e.length;r++)for(var c=e[r].fromRow;c<=e[r].toRow;c++){n[c]={};for(var d=e[r].fromCell;d<=e[r].toCell&&d<o.length;d++)n[c][o[d].id]=a}t.setCellCssStyles(i,n),clearTimeout(s),s=setTimeout((function(){l.clearCopySelection()}),2e3)}function C(){t.removeCellCssStyles(i)}e.extend(this,{init:function(e){(t=e).onKeyDown.subscribe(v);var o=e.getSelectionModel();if(!o)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())");o.onSelectedRangesChanged.subscribe((function(e,o){t.focus()}))},destroy:function(){t.onKeyDown.unsubscribe(v)},pluginName:"CellExternalCopyManager",clearCopySelection:C,handleKeyDown:v,onCopyCells:new Slick.Event,onCopyCancelled:new Slick.Event,onPasteCells:new Slick.Event,setIncludeHeaderWhenCopying:function(e){r.includeHeaderWhenCopying=e}})}}})}(jQuery),function(e){e.extend(!0,window,{Slick:{CellRangeDecorator:function(o,t){var n;function l(){n&&(n.remove(),n=null)}t=e.extend(!0,{},{selectionCssClass:"slick-range-decorator",selectionCss:{zIndex:"9999",border:"2px dashed red"},offset:{top:-1,left:-1,height:-2,width:-2}},t),e.extend(this,{pluginName:"CellRangeDecorator",show:function(l){n||(n=e("<div></div>",{css:t.selectionCss}).addClass(t.selectionCssClass).css("position","absolute").appendTo(o.getActiveCanvasNode()));var r=o.getCellNodeBox(l.fromRow,l.fromCell),i=o.getCellNodeBox(l.toRow,l.toCell);return r&&i&&t&&t.offset&&n.css({top:r.top+t.offset.top,left:r.left+t.offset.left,height:i.bottom-r.top+t.offset.height,width:i.right-r.left+t.offset.width}),n},hide:l,destroy:function(){l()}})}}})}(jQuery),function(e){e.extend(!0,window,{Slick:{CellRangeSelector:function(o){var t,n,l,r,i,a,s,c,d,u,h,p,f,m,g,v,w,C,R,S=this,$=new Slick.EventHandler,y={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},b=!1,z=0,L=0;function P(e,o){z=o.scrollTop,L=o.scrollLeft}function k(o,n){i=e(t.getActiveCanvasNode(o)),p=e(t.getActiveViewportNode(o));var l=t.getDisplayedScrollbarDimensions();f=p.width()-l.width,m=p.height()-l.height,v={x:t.getAbsoluteColumnMinWidth()/2,y:t.getOptions().rowHeight/2},b=!(!t.getPluginByName("RowMoveManager")&&!t.getPluginByName("CrossGridRowMoveManager"));i.offset();c=0,d=0,h=i.hasClass("grid-canvas-bottom"),r.frozenRow>-1&&h&&(c=r.frozenBottom?e("."+t.getUID()+" .grid-canvas-bottom").height():e("."+t.getUID()+" .grid-canvas-top").height()),u=i.hasClass("grid-canvas-right"),r.frozenColumn>-1&&u&&(d=e("."+t.getUID()+" .grid-canvas-left").width()),o.stopImmediatePropagation()}function x(o,i){var c=t.getCellFromEvent(o);if(!1!==S.onBeforeCellRangeSelected.notify(c)&&t.canCellBeSelected(c.row,c.cell)&&(a=!0,o.stopImmediatePropagation()),a){t.focus();var d=i.startX-e(l).offset().left;r.frozenColumn>=0&&u&&(d+=L);var p=i.startY-e(l).offset().top;r.frozenRow>=0&&h&&(p+=z);var f=t.getCellFromPoint(d,p);return i.range={start:f,end:{}},n=i.range,s.show(new Slick.Range(f.row,f.cell))}}function H(e,t){if(a||b){if(b||e.stopImmediatePropagation(),o.autoScroll&&(g=function(e,o){var t=e.touches?e.touches[0]:e,n=p.scrollLeft(),l=p.scrollTop(),r=n+f,i=l+m,a=p.offset(),s=a.left,c=a.top,d=s+f,u=c+m,h={e:e,dd:o,viewport:{left:n,top:l,right:r,bottom:i,offset:{left:s,top:c,right:d,bottom:u}},offset:{x:0,y:0},isOutsideViewport:!1};t.pageX<s?h.offset.x=t.pageX-s:t.pageX>d&&(h.offset.x=t.pageX-d);t.pageY<c?h.offset.y=c-t.pageY:t.pageY>u&&(h.offset.y=u-t.pageY);return h.isOutsideViewport=!!h.offset.x||!!h.offset.y,h}(e,t),g.isOutsideViewport))return function(){if(C=o.maxIntervalToShowNextCell-Math.abs(g.offset.x)*o.accelerateInterval,R=o.maxIntervalToShowNextCell-Math.abs(g.offset.y)*o.accelerateInterval,!w){var e=0,t=0;w=setInterval((function(){var n=!1,l=!1;g.offset.x?n=(e+=o.minIntervalToShowNextCell)>=C:e=0,g.offset.y?l=(t+=o.minIntervalToShowNextCell)>=R:t=0,(n||l)&&(n&&(e=0),l&&(t=0),function(e,o){var t=g.e.pageX,n=g.e.pageY,l=g.offset.x,r=g.offset.y,i=g.viewport.offset;e&&l&&(t=l>0?i.right+v.x:i.left-v.x);o&&r&&(n=r>0?i.top-v.y:i.bottom+v.y);T({pageX:t,pageY:n},g.dd)}(n,l))}),o.minIntervalToShowNextCell)}}();E(),T(e,t)}}function E(){clearInterval(w),w=null}function T(e,n){var l=e.touches?e.touches[0]:e,a=t.getCellFromPoint(l.pageX-i.offset().left+d,l.pageY-i.offset().top+c);if(!(r.frozenColumn>=0&&!u&&a.cell>r.frozenColumn||u&&a.cell<=r.frozenColumn||r.frozenRow>=0&&!h&&a.row>=r.frozenRow||h&&a.row<r.frozenRow)){if(o.autoScroll&&g){var p=t.getCellNodeBox(a.row,a.cell);if(!p)return;var f=g.viewport;(p.left<f.left||p.right>f.right||p.top<f.top||p.bottom>f.bottom)&&t.scrollCellIntoView(a.row,a.cell)}if(t.canCellBeSelected(a.row,a.cell)&&n&&n.range){n.range.end=a;var m=new Slick.Range(n.range.start.row,n.range.start.cell,a.row,a.cell);s.show(m),S.onCellRangeSelecting.notify({range:m})}}}function F(e,o){a&&(a=!1,e.stopImmediatePropagation(),E(),s.hide(),S.onCellRangeSelected.notify({range:new Slick.Range(o.range.start.row,o.range.start.cell,o.range.end.row,o.range.end.cell)}))}e.extend(this,{init:function(n){if(void 0===Slick.Draggable)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');o=e.extend(!0,{},y,o),s=o.cellDecorator||new Slick.CellRangeDecorator(n,o),l=(t=n).getCanvasNode(),r=t.getOptions(),$.subscribe(t.onScroll,P).subscribe(t.onDragInit,k).subscribe(t.onDragStart,x).subscribe(t.onDrag,H).subscribe(t.onDragEnd,F)},destroy:function(){$.unsubscribeAll(),i=null,p=null,l=null,s&&s.destroy&&s.destroy()},pluginName:"CellRangeSelector",getCellDecorator:function(){return s},getCurrentRange:function(){return n},onBeforeCellRangeSelected:new Slick.Event,onCellRangeSelected:new Slick.Event,onCellRangeSelecting:new Slick.Event})}}})}(jQuery),function(e){e.extend(!0,window,{Slick:{CellSelectionModel:function(o){var t,n,l,r=[],i=this;n=void 0===o||void 0===o.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):o.cellRangeSelector;var a={selectActiveCell:!0};function s(e){for(var o=[],n=0;n<e.length;n++){var l=e[n];t.canCellBeSelected(l.fromRow,l.fromCell)&&t.canCellBeSelected(l.toRow,l.toCell)&&o.push(l)}return o}function c(e,o){if(r&&0!==r.length||e&&0!==e.length){var t=!function(e,o){var t=e.length!==o.length;if(!t)for(var n=0;n<e.length;n++)if(e[n].fromCell!==o[n].fromCell||e[n].fromRow!==o[n].fromRow||e[n].toCell!==o[n].toCell||e[n].toRow!==o[n].toRow){t=!0;break}return!t}(r,e);if(r=s(e),t){var n=new Slick.EventData;Object.defineProperty(n,"detail",{writable:!0,configurable:!0,value:{caller:o||"SlickCellSelectionModel.setSelectedRanges"}}),i.onSelectedRangesChanged.notify(r,n)}}}function d(){return r}function u(e,o){if(t.getEditorLock().isActive())return e.stopPropagation(),!1}function h(e,o){t.setActiveCell(o.range.fromRow,o.range.fromCell,!1,!1,!0),c([o.range])}function p(e,o){l.selectActiveCell&&null!=o.row&&null!=o.cell?c([new Slick.Range(o.row,o.cell)]):l.selectActiveCell||c([])}function f(e){var o,n,l=t.getActiveCell(),r=e.ctrlKey||e.metaKey;if(l&&e.shiftKey&&!r&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){(o=d().slice()).length||o.push(new Slick.Range(l.row,l.cell)),(n=o.pop()).contains(l.row,l.cell)||(n=new Slick.Range(l.row,l.cell));var i=n.toRow-n.fromRow,a=n.toCell-n.fromCell,u=l.row==n.fromRow?1:-1,h=l.cell==n.fromCell?1:-1;37==e.which?a-=h:39==e.which?a+=h:38==e.which?i-=u:40==e.which&&(i+=u);var p=new Slick.Range(l.row,l.cell,l.row+u*i,l.cell+h*a);if(s([p]).length){o.push(p);var f=u>0?p.toRow:p.fromRow,m=h>0?p.toCell:p.fromCell;t.scrollRowIntoView(f),t.scrollCellIntoView(f,m)}else o.push(n);c(o),e.preventDefault(),e.stopPropagation()}}e.extend(this,{getSelectedRanges:d,setSelectedRanges:c,refreshSelections:function(){c(d())},init:function(r){l=e.extend(!0,{},a,o),(t=r).getCanvasNode(),t.onActiveCellChanged.subscribe(p),t.onKeyDown.subscribe(f),r.registerPlugin(n),n.onCellRangeSelected.subscribe(h),n.onBeforeCellRangeSelected.subscribe(u)},destroy:function(){t.onActiveCellChanged.unsubscribe(p),t.onKeyDown.unsubscribe(f),n.onCellRangeSelected.unsubscribe(h),n.onBeforeCellRangeSelected.unsubscribe(u),t.unregisterPlugin(n),null,n&&n.destroy&&n.destroy()},pluginName:"CellSelectionModel",onSelectedRangesChanged:new Slick.Event})}}})}(jQuery),jQuery.extend(!0,window,{Slick:{Draggable:function(e){let o,t,n,l,r,i,{containerElement:a,onDragInit:s,onDragStart:c,onDrag:d,onDragEnd:u}=e;if(a||(a=document),!a||"function"!=typeof a.addEventListener)throw new Error("[Slick.Draggable] You did not provide a valid container html element that will be used for dragging.");let h={dragSource:a,dragHandle:null};function p(e,o,t){"function"==typeof e&&e(o,t)}function f(i){o=i.target;const a=i.touches?i.touches[0]:i,{target:c}=a;if(!e.allowDragFrom||e.allowDragFrom&&o.matches(e.allowDragFrom)){h.dragHandle=o;const e={left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0};t=e.left+a.clientX,n=e.top+a.clientY,l=a.clientX-a.clientX,r=a.clientY-a.clientY,h=Object.assign(h,{deltaX:l,deltaY:r,startX:t,startY:n,target:c}),p(s,i,h),document.addEventListener("mousemove",m),document.addEventListener("touchmove",m),document.addEventListener("mouseup",g),document.addEventListener("touchend",g),document.addEventListener("touchcancel",g)}}function m(e){const o=e.touches?e.touches[0]:e;l=o.clientX-t,r=o.clientY-n;const{target:a}=o;i||(h=Object.assign(h,{deltaX:l,deltaY:r,startX:t,startY:n,target:a}),p(c,e,h),i=!0),h=Object.assign(h,{deltaX:l,deltaY:r,startX:t,startY:n,target:a}),p(d,e,h)}function g(e){const{target:o}=e;h=Object.assign(h,{target:o}),p(u,e,h),document.removeEventListener("mousemove",m),document.removeEventListener("touchmove",m),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("touchcancel",g),i=!1}return a&&(a.addEventListener("mousedown",f),a.addEventListener("touchstart",f)),{destroy:function(){a&&(a.removeEventListener("mousedown",f),a.removeEventListener("touchstart",f))}}},MouseWheel:function(e){let{element:o,onMouseWheel:t}=e;function n(e){const o=e||window.event;let n=0,l=0,r=0;o.wheelDelta&&(n=o.wheelDelta/120),o.detail&&(n=-o.detail/3),r=n,void 0!==o.axis&&o.axis===o.HORIZONTAL_AXIS&&(r=0,l=-1*n),void 0!==o.wheelDeltaY&&(r=o.wheelDeltaY/120),void 0!==o.wheelDeltaX&&(l=-1*o.wheelDeltaX/120),"function"==typeof t&&t(e,n,l,r)}return o.addEventListener("wheel",n,!1),o.addEventListener("mousewheel",n,!1),{destroy:function(){o.removeEventListener("wheel",n,!1),o.removeEventListener("mousewheel",n,!1)}}},Resizable:function(e){const{resizeableElement:o,resizeableHandleElement:t,onResizeStart:n,onResize:l,onResizeEnd:r}=e;if(!t||"function"!=typeof t.addEventListener)throw new Error("[Slick.Resizable] You did not provide a valid html element that will be used for the handle to resize.");function i(e,n){"function"==typeof e&&e(n,{resizeableElement:o,resizeableHandleElement:t})}function a(e){e.preventDefault();const o=e.touches?e.changedTouches[0]:e;i(n,o),document.addEventListener("mousemove",s),document.addEventListener("mouseup",c),document.addEventListener("touchmove",s),document.addEventListener("touchend",c)}function s(e){e.preventDefault&&"touchmove"!==e.type&&e.preventDefault();const n=e.touches?e.changedTouches[0]:e;"function"==typeof l&&(l(n,{resizeableElement:o,resizeableHandleElement:t}),l(n,{resizeableElement:o,resizeableHandleElement:t}))}function c(e){const o=e.touches?e.changedTouches[0]:e;i(r,o),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",c)}return t.addEventListener("mousedown",a),t.addEventListener("touchstart",a),{destroy:function(){t&&"function"==typeof t.removeEventListener&&(t.removeEventListener("mousedown",a),t.removeEventListener("touchstart",a))}}}}}),function(e){function o(l){var r,i,a=this;function s(){var e=l.column.editorFixedDecimalPlaces;return void 0===e&&(e=o.DefaultDecimalPlaces),e||0===e?e:null}this.args=l,this.init=function(){var o=l.grid.getOptions().editorCellNavOnLRKeys;r=e("<INPUT type=text class='editor-text' />").appendTo(l.container).on("keydown.nav",o?t:n).focus().select(),l.compositeEditorOptions&&r.on("change",(function(){var e=l.grid.getActiveCell();a.validate().valid&&a.applyValue(a.args.item,a.serializeValue()),a.applyValue(a.args.compositeEditorOptions.formValues,a.serializeValue()),l.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:a.args.item,column:a.args.column,formValues:a.args.compositeEditorOptions.formValues})}))},this.destroy=function(){r.remove()},this.focus=function(){r.focus()},this.loadValue=function(e){i=e[l.column.field];var o=s();null!==o&&(i||0===i)&&i.toFixed&&(i=i.toFixed(o)),r.val(i),r[0].defaultValue=i,r.select()},this.serializeValue=function(){var e=parseFloat(r.val());o.AllowEmptyValue?e||0===e||(e=""):e=e||0;var t=s();return null!==t&&(e||0===e)&&e.toFixed&&(e=parseFloat(e.toFixed(t))),e},this.applyValue=function(e,o){e[l.column.field]=o},this.isValueChanged=function(){return!(""===r.val()&&null==i)&&r.val()!=i},this.validate=function(){if(isNaN(r.val()))return{valid:!1,msg:"Please enter a valid number"};if(l.column.validator){var e=l.column.validator(r.val(),l);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}function t(e){var o=this.selectionStart,t=this.value.length;(e.keyCode===Slick.keyCode.LEFT&&o>0||e.keyCode===Slick.keyCode.RIGHT&&o<t-1)&&e.stopImmediatePropagation()}function n(e){e.keyCode!==Slick.keyCode.LEFT&&e.keyCode!==Slick.keyCode.RIGHT||e.stopImmediatePropagation()}o.DefaultDecimalPlaces=null,o.AllowEmptyValue=!1,e.extend(!0,window,{Slick:{Editors:{Text:function(o){var l,r,i=this;this.args=o,this.init=function(){var r=o.grid.getOptions().editorCellNavOnLRKeys;l=e("<INPUT type=text class='editor-text' />").appendTo(o.container).on("keydown.nav",r?t:n).focus().select(),o.compositeEditorOptions&&l.on("change",(function(){var e=o.grid.getActiveCell();i.validate().valid&&i.applyValue(i.args.item,i.serializeValue()),i.applyValue(i.args.compositeEditorOptions.formValues,i.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:i.args.item,column:i.args.column,formValues:i.args.compositeEditorOptions.formValues})}))},this.destroy=function(){l.remove()},this.focus=function(){l.focus()},this.getValue=function(){return l.val()},this.setValue=function(e){l.val(e)},this.loadValue=function(e){r=e[o.column.field]||"",l.val(r),l[0].defaultValue=r,l.select()},this.serializeValue=function(){return l.val()},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===l.val()&&null==r)&&l.val()!=r},this.validate=function(){if(o.column.validator){var e=o.column.validator(l.val(),o);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},Integer:function(o){var l,r,i=this;this.args=o,this.init=function(){var r=o.grid.getOptions().editorCellNavOnLRKeys;l=e("<INPUT type=text class='editor-text' />").appendTo(o.container).on("keydown.nav",r?t:n).focus().select(),o.compositeEditorOptions&&l.on("change",(function(){var e=o.grid.getActiveCell();i.validate().valid&&i.applyValue(i.args.item,i.serializeValue()),i.applyValue(i.args.compositeEditorOptions.formValues,i.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:i.args.item,column:i.args.column,formValues:i.args.compositeEditorOptions.formValues})}))},this.destroy=function(){l.remove()},this.focus=function(){l.focus()},this.loadValue=function(e){r=e[o.column.field],l.val(r),l[0].defaultValue=r,l.select()},this.serializeValue=function(){return parseInt(l.val(),10)||0},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===l.val()&&null==r)&&l.val()!=r},this.validate=function(){if(isNaN(l.val()))return{valid:!1,msg:"Please enter a valid integer"};if(o.column.validator){var e=o.column.validator(l.val(),o);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},Float:o,Date:function(o){var t,n,l=this,r=!1;this.args=o,this.init=function(){(t=e("<INPUT type=text class='editor-text' />")).appendTo(o.container),t.focus().select(),t.datepicker({showOn:"button",buttonImageOnly:!0,beforeShow:function(){r=!0},onClose:function(){if(r=!1,o.compositeEditorOptions){var e=o.grid.getActiveCell();l.validate().valid&&l.applyValue(l.args.item,l.serializeValue()),l.applyValue(l.args.compositeEditorOptions.formValues,l.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:l.args.item,column:l.args.column,formValues:l.args.compositeEditorOptions.formValues})}}}),t.width(t.width()-(o.compositeEditorOptions?28:18))},this.destroy=function(){e.datepicker.dpDiv.stop(!0,!0),t.datepicker("hide"),t.datepicker("destroy"),t.remove()},this.show=function(){r&&e.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){r&&e.datepicker.dpDiv.stop(!0,!0).hide()},this.position=function(o){r&&e.datepicker.dpDiv.css("top",o.top+30).css("left",o.left)},this.focus=function(){t.focus()},this.loadValue=function(e){n=e[o.column.field],t.val(n),t[0].defaultValue=n,t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===t.val()&&null==n)&&t.val()!=n},this.validate=function(){if(o.column.validator){var e=o.column.validator(t.val(),o);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},Flatpickr:function(o){if("undefined"==typeof flatpickr)throw new Error("Flatpickr not loaded but required in SlickGrid.Editors, refer to Flatpickr documentation: https://flatpickr.js.org/getting-started/");var t,n,l,r=this;this.args=o,this.init=function(){(t=e('<input type=text class="editor-text" />')).appendTo(o.container),t.focus().select(),l=t.flatpickr({closeOnSelect:!0,allowInput:!0,altInput:!0,altFormat:"m/d/Y",dateFormat:"m/d/Y",onChange:(e,t)=>{if(o.compositeEditorOptions){var n=o.grid.getActiveCell();r.validate().valid&&r.applyValue(r.args.item,r.serializeValue()),r.applyValue(r.args.compositeEditorOptions.formValues,r.serializeValue()),o.grid.onCompositeEditorChange.notify({row:n.row,cell:n.cell,item:r.args.item,column:r.args.column,formValues:r.args.compositeEditorOptions.formValues})}}}),o.compositeEditorOptions||setTimeout((()=>{r.show(),r.focus()}),50),t.width(t.width()-(o.compositeEditorOptions?28:18))},this.destroy=function(){r.hide(),l.destroy(),t.remove()},this.show=function(){o.compositeEditorOptions||l.open()},this.hide=function(){o.compositeEditorOptions||l.close()},this.focus=function(){t.focus()},this.loadValue=function(e){n=e[o.column.field],t.val(n),t[0].defaultValue=n,t.select(),l.setDate(n)},this.serializeValue=function(){return t.val()},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===t.val()&&null==n)&&t.val()!=n},this.validate=function(){if(o.column.validator){var e=o.column.validator(t.val(),o);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},YesNoSelect:function(o){var t,n,l=this;this.args=o,this.init=function(){(t=e("<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>")).appendTo(o.container),t.focus(),o.compositeEditorOptions&&t.on("change",(function(){var e=o.grid.getActiveCell();l.validate().valid&&l.applyValue(l.args.item,l.serializeValue()),l.applyValue(l.args.compositeEditorOptions.formValues,l.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:l.args.item,column:l.args.column,formValues:l.args.compositeEditorOptions.formValues})}))},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){t.val((n=e[o.column.field])?"yes":"no"),t.select()},this.serializeValue=function(){return"yes"==t.val()},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return t.val()!=n},this.validate=function(){return{valid:!0,msg:null}},this.init()},Checkbox:function(o){var t,n,l=this;this.args=o,this.init=function(){(t=e("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>")).appendTo(o.container),t.focus(),o.compositeEditorOptions&&t.on("change",(function(){var e=o.grid.getActiveCell();l.validate().valid&&l.applyValue(l.args.item,l.serializeValue()),l.applyValue(l.args.compositeEditorOptions.formValues,l.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:l.args.item,column:l.args.column,formValues:l.args.compositeEditorOptions.formValues})}))},this.destroy=function(){t.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){(n=!!e[o.column.field])?t.prop("checked",!0):t.prop("checked",!1)},this.preClick=function(){t.prop("checked",!t.prop("checked"))},this.serializeValue=function(){return t.prop("checked")},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return this.serializeValue()!==n},this.validate=function(){return{valid:!0,msg:null}},this.init()},PercentComplete:function(o){var t,n,l,r,i=this;this.args=o;var a=function(){t.val(this.value)},s=function(){if(o.compositeEditorOptions){var e=o.grid.getActiveCell();i.validate().valid&&i.applyValue(i.args.item,i.serializeValue()),i.applyValue(i.args.compositeEditorOptions.formValues,i.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:i.args.item,column:i.args.column,formValues:i.args.compositeEditorOptions.formValues})}};this.init=function(){(t=e('<input type="text" class="editor-percentcomplete" />')).width(e(o.container).innerWidth()-25),t.appendTo(o.container),(n=e("<div class='editor-percentcomplete-picker' />").appendTo(o.container)).append("<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><input type='range' class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>"),n.find(".editor-percentcomplete-buttons").append('<button val="0">Not started</button><br/><button val="50">In Progress</button><br/><button val="100">Complete</button>'),t.focus().select(),(r=n.find("input.editor-percentcomplete-slider")).val(l),r.on("input",a),r.on("change",s),n.find(".editor-percentcomplete-buttons button").on("click",(function(o){t.val(e(this).attr("val")),r.val(e(this).attr("val"))}))},this.destroy=function(){r.off("input",a),r.off("change",s),t.remove(),n.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){l=e[o.column.field],r.val(l),t.val(l),t.select()},this.serializeValue=function(){return parseInt(t.val(),10)||0},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===t.val()&&null==l)&&(parseInt(t.val(),10)||0)!=l},this.validate=function(){return isNaN(parseInt(t.val(),10))?{valid:!1,msg:"Please enter a valid positive number"}:{valid:!0,msg:null}},this.init()},LongText:function(o){var t,n,l,r=this;this.args=o,this.init=function(){var l=o.compositeEditorOptions,i=(o.grid.getOptions().editorCellNavOnLRKeys,l?o.container:e("body"));n=e("<DIV class='slick-large-editor-text' style='z-index:10000;background:white;padding:5px;border:3px solid gray; border-radius:10px;'/>").appendTo(i),l?n.css({position:"relative",padding:0,border:0}):n.css({position:"absolute"}),t=e("<TEXTAREA hidefocus rows=5 style='background:white;width:250px;height:80px;border:0;outline:0'>").appendTo(n),l?t.on("change",(function(){var e=o.grid.getActiveCell();r.validate().valid&&r.applyValue(r.args.item,r.serializeValue()),r.applyValue(r.args.compositeEditorOptions.formValues,r.serializeValue()),o.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:r.args.item,column:r.args.column,formValues:r.args.compositeEditorOptions.formValues})})):(e("<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>").appendTo(n),n.find("button:first").on("click",this.save),n.find("button:last").on("click",this.cancel),t.on("keydown",this.handleKeyDown),r.position(o.position)),t.focus().select()},this.handleKeyDown=function(e){if(e.which==Slick.keyCode.ENTER&&e.ctrlKey)r.save();else if(e.which==Slick.keyCode.ESCAPE)e.preventDefault(),r.cancel();else if(e.which==Slick.keyCode.TAB&&e.shiftKey)e.preventDefault(),o.grid.navigatePrev();else if(e.which==Slick.keyCode.TAB)e.preventDefault(),o.grid.navigateNext();else if((e.which==Slick.keyCode.LEFT||e.which==Slick.keyCode.RIGHT)&&o.grid.getOptions().editorCellNavOnLRKeys){var t=this.selectionStart,n=this.value.length;e.keyCode===Slick.keyCode.LEFT&&0===t&&o.grid.navigatePrev(),e.keyCode===Slick.keyCode.RIGHT&&t>=n-1&&o.grid.navigateNext()}},this.save=function(){o.commitChanges()},this.cancel=function(){t.val(l),o.cancelChanges()},this.hide=function(){n.hide()},this.show=function(){n.show()},this.position=function(e){n.css("top",e.top-5).css("left",e.left-5)},this.destroy=function(){n.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){t.val(l=e[o.column.field]),t.select()},this.serializeValue=function(){return t.val()},this.applyValue=function(e,t){e[o.column.field]=t},this.isValueChanged=function(){return!(""===t.val()&&null==l)&&t.val()!=l},this.validate=function(){if(o.column.validator){var e=o.column.validator(t.val(),o);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}}}})}(jQuery),jQuery.extend(!0,window,{Slick:{Formatters:{PercentComplete:function(e,o,t,n,l){return null==t||""===t?"-":t<50?"<span style='color:red;font-weight:bold;'>"+t+"%</span>":"<span style='color:green'>"+t+"%</span>"},PercentCompleteBar:function(e,o,t,n,l){return null==t||""===t?"":"<span class='percent-complete-bar' style='background:"+(t<30?"red":t<70?"silver":"green")+";width:"+t+"%' title='"+t+"%'></span>"},YesNo:function(e,o,t,n,l){return t?"Yes":"No"},Checkmark:function(e,o,t,n,l){return t?"<img src='../images/tick.png'>":""},Checkbox:function(e,o,t,n,l){return'<img class="slick-edit-preclick" src="../images/'+(t?"CheckboxY":"CheckboxN")+'.png">'}}}}),"undefined"==typeof jQuery)throw new Error("SlickGrid requires jquery module to be loaded");if("undefined"==typeof Slick)throw new Error('"slick.core.js" not loaded');(function($){"use strict";var scrollbarDimensions,maxSupportedCssHeight;function SlickGrid(container,data,columns,options){var defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:Slick.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,sanitizer:void 0,logSanitizedHtml:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},columnAutosizeDefaults={ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:Slick.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:Slick.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:Slick.ValueFilterMode.None,widthEvalMode:Slick.WidthEvalMode.Auto,sizeToRemaining:void 0,widthPx:void 0,contentSizePx:0,headerWidthPx:0,colDataTypeOf:void 0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$groupHeaders=$(),$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacerL,$headerRowSpacerR,$footerRow,$footerRowScroller,$footerRowSpacerL,$footerRowSpacerR,$preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer,$preHeaderPanelR,$preHeaderPanelScrollerR,$preHeaderPanelSpacerR,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,treeColumns,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,canvasWidthL,canvasWidthR,headersWidth,headersWidthL,headersWidthR,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,hasFrozenRows=!1,frozenRowsHeight=0,actualFrozenRow=-1,paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,topPanelH=0,headerRowH=0,footerRowH=0,tabbingDirection=1,$activeCanvasNode,$activeViewportNode,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows=0,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],pagingActive=!1,pagingIsLastPage=!1,scrollThrottle=ActionThrottle(render,50),h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,$paneHeaderL,$paneHeaderR,$paneTopL,$paneTopR,$paneBottomL,$paneBottomR,$headerScrollerL,$headerScrollerR,$headerL,$headerR,$groupHeadersL,$groupHeadersR,$headerRowScrollerL,$headerRowScrollerR,$footerRowScrollerL,$footerRowScrollerR,$headerRowL,$headerRowR,$footerRowL,$footerRowR,$topPanelScrollerL,$topPanelScrollerR,$topPanelL,$topPanelR,$viewportTopL,$viewportTopR,$viewportBottomL,$viewportBottomR,$canvasTopL,$canvasTopR,$canvasBottomL,$canvasBottomR,$viewportScrollContainerX,$viewportScrollContainerY,$headerScrollContainer,$headerRowScrollContainer,$footerRowScrollContainer,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],columnResizeDragging=!1,slickDraggableInstance=null,slickMouseWheelInstances=[],slickResizableInstances=[],sortableSideLeftInstance,sortableSideRightInstance;function init(){if(($container=container instanceof jQuery?container:$(container)).length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");if(maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,options.suppressCssChangesOnHiddenInit||cacheCssForHiddenInit(),treeColumns=new Slick.TreeColumns(columns),columns=treeColumns.extractColumns(),updateColumnProps(),options.enableColumnReorder&&!Sortable)throw new Error("SlickGrid requires Sortable.js module to be loaded");if(editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$paneHeaderL=$("<div class='slick-pane slick-pane-header slick-pane-left' tabIndex='0' />").appendTo($container),$paneHeaderR=$("<div class='slick-pane slick-pane-header slick-pane-right' tabIndex='0' />").appendTo($container),$paneTopL=$("<div class='slick-pane slick-pane-top slick-pane-left' tabIndex='0' />").appendTo($container),$paneTopR=$("<div class='slick-pane slick-pane-top slick-pane-right' tabIndex='0' />").appendTo($container),$paneBottomL=$("<div class='slick-pane slick-pane-bottom slick-pane-left' tabIndex='0' />").appendTo($container),$paneBottomR=$("<div class='slick-pane slick-pane-bottom slick-pane-right' tabIndex='0' />").appendTo($container),options.createPreHeaderPanel&&($preHeaderPanelScroller=$("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderL),$preHeaderPanel=$("<div />").appendTo($preHeaderPanelScroller),$preHeaderPanelSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller),$preHeaderPanelScrollerR=$("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderR),$preHeaderPanelR=$("<div />").appendTo($preHeaderPanelScrollerR),$preHeaderPanelSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScrollerR),options.showPreHeaderPanel||($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide())),$headerScrollerL=$("<div class='slick-header ui-state-default slick-header-left' />").appendTo($paneHeaderL),$headerScrollerR=$("<div class='slick-header ui-state-default slick-header-right' />").appendTo($paneHeaderR),$headerScroller=$().add($headerScrollerL).add($headerScrollerR),treeColumns.hasDepth()){$groupHeadersL=[],$groupHeadersR=[];for(var e=0;e<treeColumns.getDepth()-1;e++)$groupHeadersL[e]=$("<div class='slick-group-header-columns slick-group-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$groupHeadersR[e]=$("<div class='slick-group-header-columns slick-group-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR);$groupHeaders=$().add($groupHeadersL).add($groupHeadersR)}$headerL=$("<div class='slick-header-columns slick-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL),$headerR=$("<div class='slick-header-columns slick-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR),$headers=$().add($headerL).add($headerR),$headerRowScrollerL=$("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopL),$headerRowScrollerR=$("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopR),$headerRowScroller=$().add($headerRowScrollerL).add($headerRowScrollerR),$headerRowSpacerL=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerL),$headerRowSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerR),$headerRowL=$("<div class='slick-headerrow-columns slick-headerrow-columns-left' />").appendTo($headerRowScrollerL),$headerRowR=$("<div class='slick-headerrow-columns slick-headerrow-columns-right' />").appendTo($headerRowScrollerR),$headerRow=$().add($headerRowL).add($headerRowR),$topPanelScrollerL=$("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopL),$topPanelScrollerR=$("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopR),$topPanelScroller=$().add($topPanelScrollerL).add($topPanelScrollerR),$topPanelL=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerL),$topPanelR=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerR),$topPanel=$().add($topPanelL).add($topPanelR),options.showColumnHeader||$headerScroller.hide(),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewportTopL=$("<div class='slick-viewport slick-viewport-top slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneTopL),$viewportTopR=$("<div class='slick-viewport slick-viewport-top slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneTopR),$viewportBottomL=$("<div class='slick-viewport slick-viewport-bottom slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneBottomL),$viewportBottomR=$("<div class='slick-viewport slick-viewport-bottom slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneBottomR),$viewport=$().add($viewportTopL).add($viewportTopR).add($viewportBottomL).add($viewportBottomR),$activeViewportNode=$viewportTopL,$canvasTopL=$("<div class='grid-canvas grid-canvas-top grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportTopL),$canvasTopR=$("<div class='grid-canvas grid-canvas-top grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportTopR),$canvasBottomL=$("<div class='grid-canvas grid-canvas-bottom grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportBottomL),$canvasBottomR=$("<div class='grid-canvas grid-canvas-bottom grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportBottomR),options.viewportClass&&$viewport.toggleClass(options.viewportClass,!0),$canvas=$().add($canvasTopL).add($canvasTopR).add($canvasBottomL).add($canvasBottomR),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),$activeCanvasNode=$canvasTopL,$preHeaderPanelSpacer&&$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headers.width(getHeadersWidth()),$headerRowSpacerL.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),$headerRowSpacerR.css("width",getCanvasWidth()+scrollbarDimensions.width+"px"),options.createFooterRow&&($footerRowScrollerR=$("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopR),$footerRowScrollerL=$("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopL),$footerRowScroller=$().add($footerRowScrollerL).add($footerRowScrollerR),$footerRowSpacerL=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerL),$footerRowSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerR),$footerRowL=$("<div class='slick-footerrow-columns slick-footerrow-columns-left' />").appendTo($footerRowScrollerL),$footerRowR=$("<div class='slick-footerrow-columns slick-footerrow-columns-right' />").appendTo($footerRowScrollerR),$footerRow=$().add($footerRowL).add($footerRowR),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,getViewportWidth(),getViewportHeight(),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.on("selectstart.ui",(function(e){return $(e.target).is("input,textarea")})),setFrozenOptions(),setPaneVisibility(),setScroller(),setOverflow(),updateColumnCaches(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.on("resize.slickgrid",resizeCanvas),$viewport.on("scroll",handleScroll),options.enableMouseWheelScrollHandler&&$viewport.each((function(e,o){slickMouseWheelInstances.push(Slick.MouseWheel({element:o,onMouseWheel:handleMouseWheel}))})),$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave),$headerRowScroller.on("scroll",handleHeaderRowScroll),options.showHeaderRow&&$headerRow.on("mouseenter",".slick-headerrow-column",handleHeaderRowMouseEnter).on("mouseleave",".slick-headerrow-column",handleHeaderRowMouseLeave),options.createFooterRow&&($footerRow.on("contextmenu",handleFooterContextMenu).on("click",handleFooterClick),$footerRowScroller.on("scroll",handleFooterRowScroll)),options.createPreHeaderPanel&&$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll),$focusSink.add($focusSink2).on("keydown",handleKeyDown),$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave),jQuery.fn.drag?$canvas.on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd):Slick.Draggable&&(slickDraggableInstance=Slick.Draggable({containerElement:$container[0],allowDragFrom:"div.slick-cell",onDragInit:handleDragInit,onDragStart:handleDragStart,onDrag:handleDrag,onDragEnd:handleDragEnd})),options.suppressCssChangesOnHiddenInit||restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){($hiddenParents=$container.parents().addBack().not(":visible")).each((function(){var e={};for(var o in cssShow)e[o]=this.style[o],this.style[o]=cssShow[o];oldProps.push(e)}))}function restoreCssFromHiddenInit(){$hiddenParents.each((function(e){var o=oldProps[e];for(var t in cssShow)this.style[t]=o[t]}))}function hasFrozenColumns(){return options.frozenColumn>-1}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){for(var o=plugins.length;o>=0;o--)if(plugins[o]===e){plugins[o].destroy&&plugins[o].destroy(),plugins.splice(o,1);break}}function getPluginByName(e){for(var o=plugins.length-1;o>=0;o--)if(plugins[o].pluginName===e)return plugins[o]}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),(selectionModel=e)&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(e,o){return _getContainerElement(getCanvases(),e,o)}function getActiveCanvasNode(e){return setActiveCanvasNode(e),$activeCanvasNode[0]}function getCanvases(){return $canvas}function setActiveCanvasNode(e){e&&($activeCanvasNode=$(e.target).closest(".grid-canvas"))}function getViewportNode(e,o){return _getContainerElement(getViewports(),e,o)}function getViewports(){return $viewport}function getActiveViewportNode(e){return setActiveViewportNode(e),$activeViewportNode[0]}function setActiveViewportNode(e){e&&($activeViewportNode=$(e.target).closest(".slick-viewport"))}function _getContainerElement(e,o,t){if(e){o||(o=0),t||(t=0);var n="number"==typeof o?o:getColumnIndex(o);return e[(hasFrozenRows&&t>=actualFrozenRow+(options.frozenBottom?0:1)?2:0)+(hasFrozenColumns()&&n>options.frozenColumn?1:0)]}}function measureScrollbar(){var e=$('<div class="'+$viewport[0].className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo("body"),o=$('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo(e),t={width:e[0].offsetWidth-e[0].clientWidth,height:e[0].offsetHeight-e[0].clientHeight};return o.remove(),e.remove(),t}function getHeadersWidth(){headersWidth=headersWidthL=headersWidthR=0;for(var e=!options.autoHeight,o=0,t=columns.length;o<t;o++){var n=columns[o].width;options.frozenColumn>-1&&o>options.frozenColumn?headersWidthR+=n:headersWidthL+=n}return e&&(options.frozenColumn>-1&&o>options.frozenColumn?headersWidthR+=scrollbarDimensions.width:headersWidthL+=scrollbarDimensions.width),hasFrozenColumns()?(headersWidthL+=1e3,headersWidthR=Math.max(headersWidthR,viewportW)+headersWidthL,headersWidthR+=scrollbarDimensions.width):(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidth=headersWidthL+headersWidthR,Math.max(headersWidth,viewportW)+1e3}function getHeadersWidthL(){return headersWidthL=0,columns.forEach((function(e,o){options.frozenColumn>-1&&o>options.frozenColumn||(headersWidthL+=e.width)})),hasFrozenColumns()?headersWidthL+=1e3:(headersWidthL+=scrollbarDimensions.width,headersWidthL=Math.max(headersWidthL,viewportW)+1e3),headersWidthL}function getHeadersWidthR(){return headersWidthR=0,columns.forEach((function(e,o){options.frozenColumn>-1&&o>options.frozenColumn&&(headersWidthR+=e.width)})),hasFrozenColumns()&&(headersWidthR=Math.max(headersWidthR,viewportW)+getHeadersWidthL(),headersWidthR+=scrollbarDimensions.width),headersWidthR}function getCanvasWidth(){var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,o=columns.length;for(canvasWidthL=canvasWidthR=0;o--;)hasFrozenColumns()&&o>options.frozenColumn?canvasWidthR+=columns[o].width:canvasWidthL+=columns[o].width;var t=canvasWidthL+canvasWidthR;if(options.fullWidthRows){var n=Math.max(t,e)-t;n>0&&(t+=n,hasFrozenColumns()?canvasWidthR+=n:canvasWidthL+=n)}return t}function updateCanvasWidth(e){var o,t=canvasWidth,n=canvasWidthL,l=canvasWidthR;((o=(canvasWidth=getCanvasWidth())!==t||canvasWidthL!==n||canvasWidthR!==l)||hasFrozenColumns()||hasFrozenRows)&&($canvasTopL.width(canvasWidthL),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),hasFrozenColumns()?($canvasTopR.width(canvasWidthR),$paneHeaderL.width(canvasWidthL),$paneHeaderR.css("left",canvasWidthL),$paneHeaderR.css("width",viewportW-canvasWidthL),$paneTopL.width(canvasWidthL),$paneTopR.css("left",canvasWidthL),$paneTopR.css("width",viewportW-canvasWidthL),$headerRowScrollerL.width(canvasWidthL),$headerRowScrollerR.width(viewportW-canvasWidthL),$headerRowL.width(canvasWidthL),$headerRowR.width(canvasWidthR),options.createFooterRow&&($footerRowScrollerL.width(canvasWidthL),$footerRowScrollerR.width(viewportW-canvasWidthL),$footerRowL.width(canvasWidthL),$footerRowR.width(canvasWidthR)),options.createPreHeaderPanel&&$preHeaderPanel.width(canvasWidth),$viewportTopL.width(canvasWidthL),$viewportTopR.width(viewportW-canvasWidthL),hasFrozenRows&&($paneBottomL.width(canvasWidthL),$paneBottomR.css("left",canvasWidthL),$viewportBottomL.width(canvasWidthL),$viewportBottomR.width(viewportW-canvasWidthL),$canvasBottomL.width(canvasWidthL),$canvasBottomR.width(canvasWidthR))):($paneHeaderL.width("100%"),$paneTopL.width("100%"),$headerRowScrollerL.width("100%"),$headerRowL.width(canvasWidth),options.createFooterRow&&($footerRowScrollerL.width("100%"),$footerRowL.width(canvasWidth)),options.createPreHeaderPanel&&($preHeaderPanel.width("100%"),$preHeaderPanel.width(canvasWidth)),$viewportTopL.width("100%"),hasFrozenRows&&($viewportBottomL.width("100%"),$canvasBottomL.width(canvasWidthL)))),viewportHasHScroll=canvasWidth>=viewportW-scrollbarDimensions.width,$headerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$headerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),options.createFooterRow&&($footerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),$footerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0))),(o||e)&&applyColumnWidths()}function disableSelection(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",(function(){return!1}))}function getMaxSupportedCssHeight(){for(var e=1e6,o=navigator.userAgent.toLowerCase().match(/firefox/)?options.ffMaxSupportedCssHeight:options.maxSupportedCssHeight,t=$("<div style='display:none' />").appendTo(document.body);;){var n=2*e;if(t.css("height",n),n>o||t.height()!==n)break;e=n}return t.remove(),e}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function getDisplayedScrollbarDimensions(){return{width:viewportHasVScroll?scrollbarDimensions.width:0,height:viewportHasHScroll?scrollbarDimensions.height:0}}function getAbsoluteColumnMinWidth(){return absoluteColumnMinWidth}function bindAncestorScrollEvents(){for(var e=hasFrozenRows&&!options.frozenBottom?$canvasBottomL[0]:$canvasTopL[0];(e=e.parentNode)!=document.body&&null!=e;)if(e==$viewportTopL[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var o=$(e);$boundAncestors=$boundAncestors?$boundAncestors.add(o):o,o.on("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.off("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(e,o,t){if(initialized){var n=getColumnIndex(e);if(null!=n){var l=columns[n],r=$headers.children().eq(n);r&&(void 0!==o&&(columns[n].name=o),void 0!==t&&(columns[n].toolTip=t),trigger(self.onBeforeHeaderCellDestroy,{node:r[0],column:l,grid:self}),r.attr("title",t||"").children().eq(0).html(o),trigger(self.onHeaderCellRendered,{node:r[0],column:l,grid:self}))}}}function getHeader(e){if(!e)return hasFrozenColumns()?$headers:$headerL;var o=getColumnIndex(e.id);return hasFrozenColumns()?o<=options.frozenColumn?$headerL:$headerR:$headerL}function getHeaderColumn(e){var o="number"==typeof e?e:getColumnIndex(e),t=hasFrozenColumns()?o<=options.frozenColumn?$headerL:$headerR:$headerL,n=hasFrozenColumns()?o<=options.frozenColumn?o:o-options.frozenColumn-1:o,l=t.children().eq(n);return l&&l[0]}function getHeaderRow(){return hasFrozenColumns()?$headerRow:$headerRow[0]}function getFooterRow(){return hasFrozenColumns()?$footerRow:$footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getPreHeaderPanelRight(){return $preHeaderPanelR[0]}function getHeaderRowColumn(e){var o,t="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?t<=options.frozenColumn?o=$headerRowL:(o=$headerRowR,t-=options.frozenColumn+1):o=$headerRowL;var n=o.children().eq(t);return n&&n[0]}function getFooterRowColumn(e){var o,t="number"==typeof e?e:getColumnIndex(e);hasFrozenColumns()?t<=options.frozenColumn?o=$footerRowL:(o=$footerRowR,t-=options.frozenColumn+1):o=$footerRowL;var n=o&&o.children().eq(t);return n&&n[0]}function createColumnFooter(){if(options.createFooterRow){$footerRow.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),$footerRowR.empty();for(var e=0;e<columns.length;e++){var o=columns[e],t=$("<div class='ui-state-default slick-footerrow-column l"+e+" r"+e+"'></div>").data("column",o).addClass(hasFrozenColumns()&&e<=options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e>options.frozenColumn?$footerRowR:$footerRowL);trigger(self.onFooterRowCellRendered,{node:t[0],column:o,grid:self})}}}function createColumnGroupHeaders(){var e=0,o=!1;if(treeColumns.hasDepth()){for(var t=0;t<$groupHeadersL.length;t++){$groupHeadersL[t].empty(),$groupHeadersR[t].empty();var n=treeColumns.getColumnsInDepth(t);for(var l in n){var r=n[l];e+=r.extractColumns().length,hasFrozenColumns()&&0===t&&e-1===options.frozenColumn&&(o=!0),$("<div class='ui-state-default slick-group-header-column' />").html("<span class='slick-column-name'>"+r.name+"</span>").attr("id",""+uid+r.id).attr("title",r.toolTip||"").data("column",r).addClass(r.headerCssClass||"").addClass(hasFrozenColumns()&&e-1>options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e-1>options.frozenColumn?$groupHeadersR[t]:$groupHeadersL[t])}if(hasFrozenColumns()&&0===t&&!o){$groupHeadersL[t].empty(),$groupHeadersR[t].empty(),alert("All columns of group should to be grouped!");break}}applyColumnGroupHeaderWidths()}}function createColumnHeaders(){function e(){$(this).addClass("ui-state-hover")}function o(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each((function(){var e=$(this).data("column");e&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e,grid:self})})),$headerL.empty(),$headerR.empty(),getHeadersWidth(),$headerL.width(headersWidthL),$headerR.width(headersWidthR),$headerRow.find(".slick-headerrow-column").each((function(){var e=$(this).data("column");e&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:self})})),$headerRowL.empty(),$headerRowR.empty(),options.createFooterRow&&($footerRowL.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowL.empty(),hasFrozenColumns()&&($footerRowR.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");e&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})})),$footerRowR.empty()));for(var t=0;t<columns.length;t++){var n=columns[t],l=hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL,r=hasFrozenColumns()?t<=options.frozenColumn?$headerRowL:$headerRowR:$headerRowL,i=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+n.name+"</span>").width(n.width-headerColumnWidthDiff).attr("id",""+uid+n.id).attr("title",n.toolTip||"").attr("data-id",n.id).data("column",n).addClass(n.headerCssClass||"").addClass(hasFrozenColumns()&&t<=options.frozenColumn?"frozen":"").appendTo(l);if((options.enableColumnReorder||n.sortable)&&i.on("mouseenter",e).on("mouseleave",o),n.hasOwnProperty("headerCellAttrs")&&n.headerCellAttrs instanceof Object)for(var a in n.headerCellAttrs)n.headerCellAttrs.hasOwnProperty(a)&&i.attr(a,n.headerCellAttrs[a]);if(n.sortable&&(i.addClass("slick-header-sortable"),i.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />"),options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan&&i.append("<span class='slick-sort-indicator-numbered' />")),trigger(self.onHeaderCellRendered,{node:i[0],column:n,grid:self}),options.showHeaderRow){var s=$("<div class='ui-state-default slick-headerrow-column l"+t+" r"+t+"'></div>").data("column",n).addClass(hasFrozenColumns()&&t<=options.frozenColumn?"frozen":"").appendTo(r);trigger(self.onHeaderRowCellRendered,{node:s[0],column:n,grid:self})}if(options.createFooterRow&&options.showFooterRow){var c=$("<div class='ui-state-default slick-footerrow-column l"+t+" r"+t+"'></div>").data("column",n).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:c[0],column:n,grid:self})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&("function"==typeof options.enableColumnReorder?options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger):setupColumnReorder())}function setupColumnSort(){$headers.click((function(e){if(!columnResizeDragging&&(e.metaKey=e.metaKey||e.ctrlKey,!$(e.target).hasClass("slick-resizable-handle"))){var o=$(e.target).closest(".slick-header-column");if(o.length){var t=o.data("column");if(t.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var n=$.extend(!0,[],sortColumns),l=null,r=0;r<sortColumns.length;r++)if(sortColumns[r].columnId==t.id){(l=sortColumns[r]).sortAsc=!l.sortAsc;break}var i,a=!!l;options.tristateMultiColumnSort?(l||(l={columnId:t.id,sortAsc:t.defaultSortAsc}),a&&l.sortAsc&&(sortColumns.splice(r,1),l=null),options.multiColumnSort||(sortColumns=[]),!l||a&&options.multiColumnSort||sortColumns.push(l)):e.metaKey&&options.multiColumnSort?l&&sortColumns.splice(r,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),l?0===sortColumns.length&&sortColumns.push(l):(l={columnId:t.id,sortAsc:t.defaultSortAsc},sortColumns.push(l))),i=options.multiColumnSort?{multiColumnSort:!0,previousSortColumns:n,sortCols:$.map(sortColumns,(function(e){return{columnId:columns[getColumnIndex(e.columnId)].id,sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}}))}:{multiColumnSort:!1,previousSortColumns:n,columnId:sortColumns.length>0?t.id:null,sortCol:sortColumns.length>0?t:null,sortAsc:!(sortColumns.length>0)||sortColumns[0].sortAsc},!1!==trigger(self.onBeforeSort,i,e)&&(setSortColumns(sortColumns),trigger(self.onSort,i,e))}}}}))}function currentPositionInHeader(e){var o=0;return $headers.find(".slick-header-column").each((function(t){if(this.id==e)return o=t,!1})),o}function limitPositionInGroup(e){var o,t=0,n=0;return treeColumns.getColumnsInDepth($groupHeadersL.length-1).some((function(l){return t=n,n+=l.columns.length,l.columns.some((function(t){return t.id===e&&(o=l),o})),o})),n--,{start:t,end:n,group:o}}function remove(e,o){var t=e.lastIndexOf(o);t>-1&&(e.splice(t,1),remove(e,o))}function columnPositionValidInGroup(e){var o=currentPositionInHeader(e[0].id),t=limitPositionInGroup(e.data("column").id),n=t.start<=o&&o<=t.end;return{limit:t,valid:n,message:n?"":'Column "'.concat(e.text(),'" can be reordered only within the "',t.group.name,'" group!')}}function setupColumnReorder(){sortableSideLeftInstance&&(sortableSideLeftInstance.destroy(),sortableSideRightInstance.destroy());var e,o=null;function t(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft+10}function n(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft-10}var l={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,onStart:function(l){(e=!hasFrozenColumns()||$(l.item).offset().left>$viewportScrollContainerX.offset().left)&&l.originalEvent.pageX>$container[0].clientWidth?o||(o=setInterval(t,100)):e&&l.originalEvent.pageX<$viewportScrollContainerX.offset().left?o||(o=setInterval(n,100)):(clearInterval(o),o=null)},onEnd:function(e){var t=!1;clearInterval(o),o=null;var n=null;if(treeColumns.hasDepth()){var l=columnPositionValidInGroup(e.item);n=l.limit,(t=!l.valid)&&alert(l.message)}if(!t&&getEditorLock().commitCurrentEdit()){var r=sortableSideLeftInstance.toArray();r=r.concat(sortableSideRightInstance.toArray());for(var i=[],a=0;a<r.length;a++)i.push(columns[getColumnIndex(r[a])]);setColumns(i),trigger(self.onColumnsReordered,{impactedColumns:getImpactedColumns(n)}),e.stopPropagation(),setupColumnResize()}}};sortableSideLeftInstance=Sortable.create($headerL[0],l),sortableSideRightInstance=Sortable.create($headerR[0],l)}function getImpactedColumns(e){var o=[];if(e)for(var t=e.start;t<=e.end;t++)o.push(columns[t]);else o=columns;return o}function setupColumnResize(){if(void 0===Slick.Resizable)throw new Error('Slick.Resizable is undefined, make sure to import "slick.interactions.js"');var e,o,t,n,l,r,i,a,s,c=0;(l=$headers.children()).find(".slick-resizable-handle").remove(),l.each((function(e,o){e>=columns.length||columns[e].resizable&&(void 0===a&&(a=e),s=e)})),void 0!==a&&l.each((function(d,u){if(!(d>=columns.length||d<a||options.forceFitColumns&&d>=s)){$(u);var h=$("<div class='slick-resizable-handle' />");h.appendTo(u).on("dblclick",(function(){var e=$(this).parent().attr("id").replace(uid,"");trigger(self.onColumnsResizeDblClick,{triggeredByColumn:e})})),slickResizableInstances.push(Slick.Resizable({resizeableElement:u,resizeableHandleElement:h[0],onResizeStart:function(o,a){var s=o.touches?o.touches[0]:o;if(!getEditorLock().commitCurrentEdit())return!1;n=s.pageX,c=0,$(a.resizeableElement).addClass("slick-header-column-active");var u=null,h=null;if(l.each((function(e,o){e>=columns.length||(columns[e].previousWidth=$(o).outerWidth())})),options.forceFitColumns)for(u=0,h=0,e=d+1;e<columns.length;e++)(t=columns[e]).resizable&&(null!==h&&(t.maxWidth?h+=t.maxWidth-t.previousWidth:h=null),u+=t.previousWidth-Math.max(t.minWidth||0,absoluteColumnMinWidth));var p=0,f=0;for(e=0;e<=d;e++)(t=columns[e]).resizable&&(null!==f&&(t.maxWidth?f+=t.maxWidth-t.previousWidth:f=null),p+=t.previousWidth-Math.max(t.minWidth||0,absoluteColumnMinWidth));null===u&&(u=1e5),null===p&&(p=1e5),null===h&&(h=1e5),null===f&&(f=1e5),i=n+Math.min(u,f),r=n-Math.min(p,h)},onResize:function(l,a){var s=l.touches?l.touches[0]:l;columnResizeDragging=!0;var u,h,p=Math.min(i,Math.max(r,s.pageX))-n,f=0,m=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;if(p<0){for(h=p,e=d;e>=0;e--)(t=columns[e]).resizable&&(u=Math.max(t.minWidth||0,absoluteColumnMinWidth),h&&t.previousWidth+h<u?(h+=t.previousWidth-u,t.width=u):(t.width=t.previousWidth+h,h=0));for(o=0;o<=d;o++)t=columns[o],hasFrozenColumns()&&o>options.frozenColumn?t.width:f+=t.width;if(options.forceFitColumns)for(h=-p,e=d+1;e<columns.length;e++)(t=columns[e]).resizable&&(h&&t.maxWidth&&t.maxWidth-t.previousWidth<h?(h-=t.maxWidth-t.previousWidth,t.width=t.maxWidth):(t.width=t.previousWidth+h,h=0),hasFrozenColumns()&&e>options.frozenColumn?t.width:f+=t.width);else for(e=d+1;e<columns.length;e++)t=columns[e],hasFrozenColumns()&&e>options.frozenColumn?t.width:f+=t.width;if(options.forceFitColumns)for(h=-p,e=d+1;e<columns.length;e++)(t=columns[e]).resizable&&(h&&t.maxWidth&&t.maxWidth-t.previousWidth<h?(h-=t.maxWidth-t.previousWidth,t.width=t.maxWidth):(t.width=t.previousWidth+h,h=0))}else{for(h=p,f=0,0,e=d;e>=0;e--)if((t=columns[e]).resizable)if(h&&t.maxWidth&&t.maxWidth-t.previousWidth<h)h-=t.maxWidth-t.previousWidth,t.width=t.maxWidth;else{var g=t.previousWidth+h,v=canvasWidthL+h;hasFrozenColumns()&&e<=options.frozenColumn?(g>c&&v<m-options.frozenRightViewportMinWidth&&(c=g),t.width=v+options.frozenRightViewportMinWidth>m?c:g):t.width=g,h=0}for(o=0;o<=d;o++)t=columns[o],hasFrozenColumns()&&o>options.frozenColumn?t.width:f+=t.width;if(options.forceFitColumns)for(h=-p,e=d+1;e<columns.length;e++)(t=columns[e]).resizable&&(u=Math.max(t.minWidth||0,absoluteColumnMinWidth),h&&t.previousWidth+h<u?(h+=t.previousWidth-u,t.width=u):(t.width=t.previousWidth+h,h=0),hasFrozenColumns()&&e>options.frozenColumn?t.width:f+=t.width);else for(e=d+1;e<columns.length;e++)t=columns[e],hasFrozenColumns()&&e>options.frozenColumn?t.width:f+=t.width}hasFrozenColumns()&&f!=canvasWidthL&&($headerL.width(f+1e3),$paneHeaderR.css("left",f)),applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths(),trigger(self.onColumnsDrag,{triggeredByColumn:$(a.resizeableElement),resizeHandle:$(a.resizeableHandleElement)})},onResizeEnd:function(o,n){$(n.resizeableElement).removeClass("slick-header-column-active");var r,i=$(n.resizeableElement).attr("id").replace(uid,"");for(!0===trigger(self.onBeforeColumnsResize,{triggeredByColumn:i})&&(applyColumnHeaderWidths(),applyColumnGroupHeaderWidths()),e=0;e<columns.length;e++)t=columns[e],r=$(l[e]).outerWidth(),t.previousWidth!==r&&t.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{triggeredByColumn:i}),setTimeout((function(){columnResizeDragging=!1}),300)}}))}}))}function getVBoxDelta(e){var o=0;return e&&"function"==typeof e.css&&$.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],(function(t,n){o+=parseFloat(e.css(n))||0})),o}function setFrozenOptions(){if(options.frozenColumn=options.frozenColumn>=0&&options.frozenColumn<columns.length?parseInt(options.frozenColumn):-1,options.frozenRow>-1){hasFrozenRows=!0,frozenRowsHeight=options.frozenRow*options.rowHeight;var e=getDataLength();actualFrozenRow=options.frozenBottom?e-options.frozenRow:options.frozenRow}else hasFrozenRows=!1}function setPaneVisibility(){hasFrozenColumns()?($paneHeaderR.show(),$paneTopR.show(),hasFrozenRows?($paneBottomL.show(),$paneBottomR.show()):($paneBottomR.hide(),$paneBottomL.hide())):($paneHeaderR.hide(),$paneTopR.hide(),$paneBottomR.hide(),hasFrozenRows?$paneBottomL.show():($paneBottomR.hide(),$paneBottomL.hide()))}function setOverflow(){$viewportTopL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportTopR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),hasFrozenRows?"scroll":"auto")}),$viewportBottomL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?"hidden":hasFrozenRows?"scroll":"auto"}),$viewportBottomR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":(hasFrozenRows&&options.alwaysAllowHorizontalScroll,"auto"),"overflow-y":options.alwaysShowVerticalScroll?"scroll":(hasFrozenColumns(),"auto")}),options.viewportClass&&($viewportTopL.toggleClass(options.viewportClass,!0),$viewportTopR.toggleClass(options.viewportClass,!0),$viewportBottomL.toggleClass(options.viewportClass,!0),$viewportBottomR.toggleClass(options.viewportClass,!0))}function setScroller(){hasFrozenColumns()?($headerScrollContainer=$headerScrollerR,$headerRowScrollContainer=$headerRowScrollerR,$footerRowScrollContainer=$footerRowScrollerR,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomR,$viewportScrollContainerY=$viewportTopR):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomR:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopR):($headerScrollContainer=$headerScrollerL,$headerRowScrollContainer=$headerRowScrollerL,$footerRowScrollContainer=$footerRowScrollerL,hasFrozenRows?options.frozenBottom?($viewportScrollContainerX=$viewportBottomL,$viewportScrollContainerY=$viewportTopL):$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomL:$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopL)}function measureCellPaddingAndBorder(){var e,o=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],n=$.fn.jquery.split(".");jQueryNewWidthBehaviour=1==n[0]&&n[1]>=8||n[0]>=2,e=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($.each(o,(function(o,t){headerColumnWidthDiff+=parseFloat(e.css(t))||0})),$.each(t,(function(o,t){headerColumnHeightDiff+=parseFloat(e.css(t))||0}))),e.remove();var l=$("<div class='slick-row' />").appendTo($canvas);e=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(l),cellWidthDiff=cellHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($.each(o,(function(o,t){cellWidthDiff+=parseFloat(e.css(t))||0})),$.each(t,(function(o,t){cellHeightDiff+=parseFloat(e.css(t))||0}))),l.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));for(var e=options.rowHeight-cellHeightDiff,o=["."+uid+" .slick-group-header-column { left: 1000px; }","."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+e+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],t=0;t<columns.length;t++)o.push("."+uid+" .l"+t+" { }"),o.push("."+uid+" .r"+t+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=o.join(" "):$style[0].appendChild(document.createTextNode(o.join(" ")))}function getColumnCssRules(e){var o;if(!stylesheet){var t=document.styleSheets;for(o=0;o<t.length;o++)if((t[o].ownerNode||t[o].owningElement)==$style[0]){stylesheet=t[o];break}if(!stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];var n,l,r=stylesheet.cssRules||stylesheet.rules;for(o=0;o<r.length;o++){var i=r[o].selectorText;(n=/\.l\d+/.exec(i))?(l=parseInt(n[0].substr(2,n[0].length-2),10),columnCssRulesL[l]=r[o]):(n=/\.r\d+/.exec(i))&&(l=parseInt(n[0].substr(2,n[0].length-2),10),columnCssRulesR[l]=r[o])}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(e){slickDraggableInstance=destroyAllInstances(slickDraggableInstance),slickMouseWheelInstances=destroyAllInstances(slickMouseWheelInstances),slickResizableInstances=destroyAllInstances(slickResizableInstances),getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var o=plugins.length;o--;)unregisterPlugin(plugins[o]);options.enableColumnReorder&&sortableSideLeftInstance&&"function"==typeof sortableSideLeftInstance.destroy&&(sortableSideLeftInstance.destroy(),sortableSideRightInstance.destroy()),unbindAncestorScrollEvents(),$container.off(".slickgrid"),removeCssRules(),$canvas.off(),$viewport.off(),$headerScroller.off(),$headerRowScroller.off(),$footerRow&&$footerRow.off(),$footerRowScroller&&$footerRowScroller.off(),$preHeaderPanelScroller&&$preHeaderPanelScroller.off(),$focusSink.off(),$(".slick-resizable-handle").off(),$(".slick-header-column").off(),$container.empty().removeClass(uid),e&&destroyAllElements()}function destroyAllInstances(e){if(e){const o=Array.isArray(e)?e:[e];let t;for(;null!=(t=o.pop());)t&&"function"==typeof t.destroy&&t.destroy()}return e=Array.isArray(e)?[]:null}function destroyAllElements(){$activeCanvasNode=null,$activeViewportNode=null,$boundAncestors=null,$canvas=null,$canvasTopL=null,$canvasTopR=null,$canvasBottomL=null,$canvasBottomR=null,$container=null,$focusSink=null,$focusSink2=null,$groupHeaders=null,$groupHeadersL=null,$groupHeadersR=null,$headerL=null,$headerR=null,$headers=null,$headerRow=null,$headerRowL=null,$headerRowR=null,$headerRowSpacerL=null,$headerRowSpacerR=null,$headerRowScrollContainer=null,$headerRowScroller=null,$headerRowScrollerL=null,$headerRowScrollerR=null,$headerScrollContainer=null,$headerScroller=null,$headerScrollerL=null,$headerScrollerR=null,$hiddenParents=null,$footerRow=null,$footerRowL=null,$footerRowR=null,$footerRowSpacerL=null,$footerRowSpacerR=null,$footerRowScroller=null,$footerRowScrollerL=null,$footerRowScrollerR=null,$footerRowScrollContainer=null,$preHeaderPanel=null,$preHeaderPanelR=null,$preHeaderPanelScroller=null,$preHeaderPanelScrollerR=null,$preHeaderPanelSpacer=null,$preHeaderPanelSpacerR=null,$topPanel=null,$topPanelScroller=null,$style=null,$topPanelScrollerL=null,$topPanelScrollerR=null,$topPanelL=null,$topPanelR=null,$paneHeaderL=null,$paneHeaderR=null,$paneTopL=null,$paneTopR=null,$paneBottomL=null,$paneBottomR=null,$viewport=null,$viewportTopL=null,$viewportTopR=null,$viewportBottomL=null,$viewportBottomR=null,$viewportScrollContainerX=null,$viewportScrollContainerY=null}var canvas=null,canvas_context=null;function autosizeColumn(e,o){var t=null,n=-1;if("number"==typeof e)t=columns[e],n=e;else if("string"==typeof e)for(i=0;i<columns.length;i++)columns[i].Id===e&&(t=columns[i],n=i);t&&getColAutosizeWidth(t,n,$(getCanvasNode(0,0)),o,n)}function treatAsLocked(e){return!e.ignoreHeaderText&&!e.sizeToRemaining&&e.contentSizePx===e.headerWidthPx&&e.widthPx<100}function autosizeColumns(e,o){var t={hiddenParents:null,oldPropArr:[]};cacheCssForHiddenInit(t),internalAutosizeColumns(e,o),restoreCssFromHiddenInit(t)}function internalAutosizeColumns(e,o){if((e=e||options.autosizeColsMode)!==Slick.GridAutosizeColsMode.LegacyForceFit&&e!==Slick.GridAutosizeColsMode.LegacyOff){if(e!==Slick.GridAutosizeColsMode.None){(canvas=document.createElement("canvas"))&&canvas.getContext&&(canvas_context=canvas.getContext("2d"));var t,n,l,r,i=$(getCanvasNode(0,0)),a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,s=0,c=0,d=0,u=0,h=0;for(t=0;t<columns.length;t++)getColAutosizeWidth(n=columns[t],t,i,o,t),h+=n.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?n.width:treatAsLocked(n.autoSize)?n.autoSize.widthPx:0,u+=n.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?n.width:treatAsLocked(n.autoSize)?n.autoSize.widthPx:n.minWidth,s+=n.autoSize.widthPx,c+=n.autoSize.sizeToRemaining?0:n.autoSize.widthPx,d+=n.autoSize.sizeToRemaining&&n.minWidth||0;var p=s-c;if(e===Slick.GridAutosizeColsMode.FitViewportToCols){var f=s+scrollbarDimensions.width;e=Slick.GridAutosizeColsMode.IgnoreViewport,options.viewportMaxWidthPx&&f>options.viewportMaxWidthPx?(f=options.viewportMaxWidthPx,e=Slick.GridAutosizeColsMode.FitColsToViewport):options.viewportMinWidthPx&&f<options.viewportMinWidthPx&&(f=options.viewportMinWidthPx,e=Slick.GridAutosizeColsMode.FitColsToViewport),$container.width(f)}if(e===Slick.GridAutosizeColsMode.FitColsToViewport)if(p>0&&c<a-d)for(t=0;t<columns.length;t++){var m=a-c;l=(n=columns[t]).autoSize.sizeToRemaining?m*n.autoSize.widthPx/p:n.autoSize.widthPx,n.rerenderOnResize&&n.width!=l&&(r=!0),n.width=l}else if(options.viewportSwitchToScrollModeWidthPercent&&c+d>a*options.viewportSwitchToScrollModeWidthPercent/100||u>a)e=Slick.GridAutosizeColsMode.IgnoreViewport;else{var g=c-h,v=a-h-d;for(t=0;t<columns.length;t++)l=(n=columns[t]).width,n.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked||treatAsLocked(n.autoSize)||(n.autoSize.sizeToRemaining?l=n.minWidth:((l=v/g*n.autoSize.widthPx-1)<n.minWidth&&(l=n.minWidth),g-=n.autoSize.widthPx,v-=l)),treatAsLocked(n.autoSize)&&(l=n.autoSize.widthPx)<n.minWidth&&(l=n.minWidth),n.rerenderOnResize&&n.width!=l&&(r=!0),n.width=l}if(e===Slick.GridAutosizeColsMode.IgnoreViewport)for(t=0;t<columns.length;t++)l=columns[t].autoSize.widthPx,columns[t].rerenderOnResize&&columns[t].width!=l&&(r=!0),columns[t].width=l;reRenderColumns(r)}}else legacyAutosizeColumns()}function LogColWidths(){for(var e="Col Widths:",o=0;o<columns.length;o++)e+=" "+columns[o].width;console.log(e)}function getColAutosizeWidth(e,o,t,n,l){var r=e.autoSize;if(r.widthPx=e.width,r.autosizeMode===Slick.ColAutosizeMode.Locked||r.autosizeMode===Slick.ColAutosizeMode.Guide)return;var i=getDataLength();const a=new RegExp(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/);if(r.autosizeMode===Slick.ColAutosizeMode.ContentIntelligent){var s,c=r.colDataTypeOf;if(i>0){var d=getDataItem(0);d&&(s=d[e.field],a.test(s)&&(s=Date.parse(s)),"object"===(c=typeof s)&&(s instanceof Date&&(c="date"),"undefined"!=typeof moment&&s instanceof moment&&(c="moment")))}"boolean"===c&&(r.colValueArray=[!0,!1]),"number"===c&&(r.valueFilterMode=Slick.ValueFilterMode.GetGreatestAndSub,r.rowSelectionMode=Slick.RowSelectionMode.AllRows),"string"===c&&(r.valueFilterMode=Slick.ValueFilterMode.GetLongestText,r.rowSelectionMode=Slick.RowSelectionMode.AllRows,r.allowAddlPercent=5),"date"===c&&(r.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===c&&"undefined"!=typeof moment&&(r.colValueArray=[moment([2009,8,30,12,20,20])])}var u=r.contentSizePx=getColContentSize(e,o,t,n,l);0===u&&(u=r.widthPx),u=u*(r.allowAddlPercent?1+r.allowAddlPercent/100:1)+options.autosizeColPaddingPx,e.minWidth&&u<e.minWidth&&(u=e.minWidth),e.maxWidth&&u>e.maxWidth&&(u=e.maxWidth),(r.autosizeMode===Slick.ColAutosizeMode.ContentExpandOnly||e.editor&&e.editor.ControlFillsColumn)&&u<e.width&&(u=e.width),r.widthPx=u}function getColContentSize(e,o,t,n,l){var r,i,a=e.autoSize,s=1,c=0,d=0;if(a.headerWidthPx=0,a.ignoreHeaderText||(a.headerWidthPx=getColHeaderWidth(e)),0===a.headerWidthPx&&(a.headerWidthPx=e.width?e.width:e.maxWidth?e.maxWidth:e.minWidth?e.minWidth:20),a.colValueArray)return d=getColWidth(e,t,a.colValueArray),Math.max(a.headerWidthPx,d);var u={};u.colIndex=o,u.rowCount=getDataLength(),u.startIndex=0,u.endIndex=u.rowCount-1,u.valueArr=null,u.getRowVal=function(o){return getDataItem(o)[e.field]};var h=(n?a.rowSelectionModeOnInit:void 0)||a.rowSelectionMode;if(h===Slick.RowSelectionMode.FirstRow&&(u.endIndex=0),h===Slick.RowSelectionMode.LastRow&&(u.endIndex=u.startIndex=u.rowCount-1),h===Slick.RowSelectionMode.FirstNRows&&(u.endIndex=Math.min(a.rowSelectionCount,u.rowCount)-1),a.valueFilterMode===Slick.ValueFilterMode.DeDuplicate){var p={};for(r=u.startIndex;r<=u.endIndex;r++)p[u.getRowVal(r)]=!0;if(Object.keys)u.valueArr=Object.keys(p);else for(var f in u.valueArr=[],p)u.valueArr.push(f);u.startIndex=0,u.endIndex=u.length-1}if(a.valueFilterMode===Slick.ValueFilterMode.GetGreatestAndSub){var m,g=0;for(r=u.startIndex;r<=u.endIndex;r++)i=u.getRowVal(r),Math.abs(i)>g&&(m=i,g=Math.abs(i));m=""+m,m=+(m=Array(m.length+1).join("9")),u.valueArr=[m],u.startIndex=u.endIndex=0}if(a.valueFilterMode===Slick.ValueFilterMode.GetLongestTextAndSub){for(r=u.startIndex;r<=u.endIndex;r++)((i=u.getRowVal(r))||"").length>c&&(c=i.length);i=Array(c+1).join("m"),s=options.autosizeTextAvgToMWidthRatio,u.maxLen=c,u.valueArr=[i],u.startIndex=u.endIndex=0}if(a.valueFilterMode===Slick.ValueFilterMode.GetLongestText){c=0;var v=0;for(r=u.startIndex;r<=u.endIndex;r++)((i=u.getRowVal(r))||"").length>c&&(c=i.length,v=r);i=u.getRowVal(v),u.maxLen=c,u.valueArr=[i],u.startIndex=u.endIndex=0}return u.maxLen&&u.maxLen>30&&l>1&&(a.sizeToRemaining=!0),d=getColWidth(e,t,u)*s,Math.max(a.headerWidthPx,d)}function getColWidth(e,o,t){var n=$('<div class="slick-row ui-widget-content"></div>'),l=$('<div class="slick-cell"></div>');l.css({position:"absolute",visibility:"hidden","text-overflow":"initial","white-space":"nowrap"}),n.append(l),o.append(n);var r,i,a,s,c,d=0,u=e.autoSize.widthEvalMode===Slick.WidthEvalMode.TextOnly;if(e.autoSize.widthEvalMode===Slick.WidthEvalMode.Auto){var h=!e.formatterOverride&&!e.formatter,p=e.formatterOverride&&e.formatterOverride.ReturnsTextOnly||!e.formatterOverride&&e.formatter&&e.formatter.ReturnsTextOnly;u=h||p}if(canvas_context&&u){for(canvas_context.font=l.css("font-size")+" "+l.css("font-family"),r=t.startIndex;r<=t.endIndex;r++)c=t.valueArr?t.valueArr[r]:t.getRowVal(r),(i=(s=e.formatterOverride?e.formatterOverride(r,t.colIndex,c,e,getDataItem(r),self):e.formatter?e.formatter(r,t.colIndex,c,e,getDataItem(r),self):""+c)?canvas_context.measureText(s).width:0)>d&&(d=i,a=s);return l.html(a),i=l.outerWidth(),n.remove(),i}for(r=t.startIndex;r<=t.endIndex;r++)c=t.valueArr?t.valueArr[r]:t.getRowVal(r),applyFormatResultToCellNode(s=e.formatterOverride?e.formatterOverride(r,t.colIndex,c,e,getDataItem(r),self):e.formatter?e.formatter(r,t.colIndex,c,e,getDataItem(r),self):""+c,l[0]),(i=l.outerWidth())>d&&(d=i);return n.remove(),d}function getColHeaderWidth(e){var o=0,t=getUID()+e.id,n=document.getElementById(t),l=t+"_";if(n){var r=n.cloneNode(!0);r.id=l,r.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",n.parentNode.insertBefore(r,n),o=r.offsetWidth,r.parentNode.removeChild(r)}else{var i=getHeader(e);o=(n=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+e.name+"</span>").attr("id",l).css({position:"absolute",visibility:"hidden",right:"auto","text-overflow:":"initial","white-space":"nowrap"}).addClass(e.headerCssClass||"").appendTo(i))[0].offsetWidth,i[0].removeChild(n[0])}return o}function legacyAutosizeColumns(){var e,o,t,n=[],l=0,r=0,i=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++)o=columns[e],n.push(o.width),r+=o.width,o.resizable&&(l+=o.width-Math.max(o.minWidth,absoluteColumnMinWidth));for(t=r;r>i&&l;){var a=(r-i)/l;for(e=0;e<columns.length&&r>i;e++){o=columns[e];var s=n[e];if(!(!o.resizable||s<=o.minWidth||s<=absoluteColumnMinWidth)){var c=Math.max(o.minWidth,absoluteColumnMinWidth),d=Math.floor(a*(s-c))||1;r-=d=Math.min(d,s-c),l-=d,n[e]-=d}}if(t<=r)break;t=r}for(t=r;r<i;){var u=i/r;for(e=0;e<columns.length&&r<i;e++){o=columns[e];var h,p=n[e];r+=h=!o.resizable||o.maxWidth<=p?0:Math.min(Math.floor(u*p)-p,o.maxWidth-p||1e6)||1,n[e]+=r<=i?h:0}if(t>=r)break;t=r}var f=!1;for(e=0;e<columns.length;e++)columns[e].rerenderOnResize&&columns[e].width!=n[e]&&(f=!0),columns[e].width=n[e];reRenderColumns(f)}function reRenderColumns(e){applyColumnHeaderWidths(),applyColumnGroupHeaderWidths(),updateCanvasWidth(!0),trigger(self.onAutosizeColumns,{columns:columns}),e&&(invalidateAllRows(),render())}function trigger(e,o,t){return t=t||new Slick.EventData,(o=o||{}).grid=self,e.notify(o,t,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function applyColumnGroupHeaderWidths(){if(treeColumns.hasDepth())for(var e=$groupHeadersL.length-1;e>=0;e--){treeColumns.getColumnsInDepth(e);$().add($groupHeadersL[e]).add($groupHeadersR[e]).each((function(e){var o=$(this),t=0;o.width(0===e?getHeadersWidthL():getHeadersWidthR()),o.children().each((function(){var e=$(this),n=$(this).data("column");n.width=0,n.columns.forEach((function(){var e=o.next().children(":eq("+t+++")");n.width+=e.outerWidth()})),e.width(n.width-headerColumnWidthDiff)}))}))}}function applyColumnHeaderWidths(){if(initialized){for(var e,o=0,t=$headers.children(),n=columns.length;o<n;o++)e=$(t[o]),jQueryNewWidthBehaviour?e.outerWidth()!==columns[o].width&&e.outerWidth(columns[o].width):e.width()!==columns[o].width-headerColumnWidthDiff&&e.width(columns[o].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var e,o,t=0,n=0;n<columns.length;n++)e=columns[n].width,(o=getColumnCssRules(n)).left.style.left=t+"px",o.right.style.right=(-1!=options.frozenColumn&&n>options.frozenColumn?canvasWidthR:canvasWidthL)-t-e+"px",options.frozenColumn==n?t=0:t+=columns[n].width}function setSortColumn(e,o){setSortColumns([{columnId:e,sortAsc:o}])}function setSortColumns(e){sortColumns=e;var o=options.numberedMultiColumnSort&&sortColumns.length>1,t=$headers.children();t.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),t.find(".slick-sort-indicator-numbered").text(""),$.each(sortColumns,(function(e,n){null==n.sortAsc&&(n.sortAsc=!0);var l=getColumnIndex(n.columnId);null!=l&&(t.eq(l).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(n.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),o&&t.eq(l).find(".slick-sort-indicator-numbered").text(e+1))}))}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,o){var t=selectedRows.slice(0);selectedRows=[];for(var n={},l=0;l<o.length;l++)for(var r=o[l].fromRow;r<=o[l].toRow;r++){n[r]||(selectedRows.push(r),n[r]={});for(var i=o[l].fromCell;i<=o[l].toCell;i++)canCellBeSelected(r,i)&&(n[r][columns[i].id]=options.selectedCellCssClass)}if(setCellCssStyles(options.selectedCellCssClass,n),simpleArrayEquals(t,selectedRows)){var a=e&&e.detail&&e.detail.caller||"click",s=getSelectedRows().filter((function(e){return t.indexOf(e)<0})),c=t.filter((function(e){return getSelectedRows().indexOf(e)<0}));trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),previousSelectedRows:t,caller:a,changedSelectedRows:s,changedUnselectedRows:c},e)}}function simpleArrayEquals(e,o){return Array.isArray(e)&&Array.isArray(o)&&o.sort().toString()!==e.sort().toString()}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var e=0,o=0,t=columns.length;o<t;o++)columnPosLeft[o]=e,columnPosRight[o]=e+columns[o].width,options.frozenColumn==o?e=0:e+=columns[o].width}function updateColumnProps(){columnsById={};for(var e=0;e<columns.length;e++){columns[e].width&&(columns[e].widthRequest=columns[e].width);var o=columns[e]=$.extend({},columnDefaults,columns[e]);o.autoSize=$.extend({},columnAutosizeDefaults,o.autoSize),columnsById[o.id]=e,o.minWidth&&o.width<o.minWidth&&(o.width=o.minWidth),o.maxWidth&&o.width>o.maxWidth&&(o.width=o.maxWidth),o.resizable}}function setColumns(e){trigger(self.onBeforeSetColumns,{previousColumns:columns,newColumns:e,grid:self});var o=new Slick.TreeColumns(e);columns=o.hasDepth()?(treeColumns=o).extractColumns():e,updateColumnProps(),updateColumnCaches(),initialized&&(setPaneVisibility(),setOverflow(),invalidateAllRows(),createColumnHeaders(),createColumnGroupHeaders(),createColumnFooter(),removeCssRules(),createCssRules(),resizeCanvas(),updateCanvasWidth(),applyColumnHeaderWidths(),applyColumnWidths(),handleScroll(),getSelectionModel()&&getSelectionModel().refreshSelections&&getSelectionModel().refreshSelections())}function getOptions(){return options}function setOptions(e,o,t,n){if(getEditorLock().commitCurrentEdit()){makeActiveCellNormal(),void 0!==e.showColumnHeader&&setColumnHeaderVisibility(e.showColumnHeader),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength());var l=$.extend(!0,{},options);options=$.extend(options,e),trigger(self.onSetOptions,{optionsBefore:l,optionsAfter:options}),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),o||render(),setFrozenOptions(),setScroller(),n||setOverflow(),t||setColumns(treeColumns.extractColumns()),!options.enableMouseWheelScrollHandler||!$viewport||slickMouseWheelInstances&&0!==slickMouseWheelInstances.length?!1===options.enableMouseWheelScrollHandler&&destroyAllInstances(slickMouseWheelInstances):$viewport.each((function(e,o){slickMouseWheelInstances.push(Slick.MouseWheel({element:o,onMouseWheel:handleMouseWheel}))}))}}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1),options.forceFitColumns&&(options.autosizeColsMode=Slick.GridAutosizeColsMode.LegacyForceFit,console.log("forceFitColumns option is deprecated - use autosizeColsMode"))}function setData(e,o){data=e,invalidateAllRows(),updateRowCount(),o&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data&&data.length||0}function getDataLengthIncludingAddNew(){return getDataLength()+(options.enableAddRow&&(!pagingActive||pagingIsLastPage)?1:0)}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e,o){var t=!1!==o;options.showTopPanel!=e&&(options.showTopPanel=e,e?t?$topPanelScroller.slideDown("fast",resizeCanvas):($topPanelScroller.show(),resizeCanvas()):t?$topPanelScroller.slideUp("fast",resizeCanvas):($topPanelScroller.hide(),resizeCanvas()))}function setHeaderRowVisibility(e,o){var t=!1!==o;options.showHeaderRow!=e&&(options.showHeaderRow=e,e?t?$headerRowScroller.slideDown("fast",resizeCanvas):($headerRowScroller.show(),resizeCanvas()):t?$headerRowScroller.slideUp("fast",resizeCanvas):($headerRowScroller.hide(),resizeCanvas()))}function setColumnHeaderVisibility(e,o){options.showColumnHeader!=e&&(options.showColumnHeader=e,e?o?$headerScroller.slideDown("fast",resizeCanvas):($headerScroller.show(),resizeCanvas()):o?$headerScroller.slideUp("fast",resizeCanvas):($headerScroller.hide(),resizeCanvas()))}function setFooterRowVisibility(e,o){var t=!1!==o;options.showFooterRow!=e&&(options.showFooterRow=e,e?t?$footerRowScroller.slideDown("fast",resizeCanvas):($footerRowScroller.show(),resizeCanvas()):t?$footerRowScroller.slideUp("fast",resizeCanvas):($footerRowScroller.hide(),resizeCanvas()))}function setPreHeaderPanelVisibility(e,o){var t=!1!==o;options.showPreHeaderPanel!=e&&(options.showPreHeaderPanel=e,e?t?($preHeaderPanelScroller.slideDown("fast",resizeCanvas),$preHeaderPanelScrollerR.slideDown("fast",resizeCanvas)):($preHeaderPanelScroller.show(),$preHeaderPanelScrollerR.show(),resizeCanvas()):t?($preHeaderPanelScroller.slideUp("fast",resizeCanvas),$preHeaderPanelScrollerR.slideUp("fast",resizeCanvas)):($preHeaderPanelScroller.hide(),$preHeaderPanelScrollerR.hide(),resizeCanvas()))}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0),e=Math.min(e,th-$viewportScrollContainerY.height()+(viewportHasHScroll||hasFrozenColumns()?scrollbarDimensions.height:0));var o=offset;page=Math.min(n-1,Math.floor(e/ph));var t=e-(offset=Math.round(page*cj));offset!=o&&(cleanupRows(getVisibleRange(t)),updateRowPositions());prevScrollTop!=t&&(vScrollDir=prevScrollTop+o<t+offset?1:-1,lastRenderedScrollTop=scrollTop=prevScrollTop=t,hasFrozenColumns()&&($viewportTopL[0].scrollTop=t),hasFrozenRows&&($viewportBottomL[0].scrollTop=$viewportBottomR[0].scrollTop=t),$viewportScrollContainerY[0].scrollTop=t,trigger(self.onViewportChanged,{}))}function defaultFormatter(e,o,t,n,l,r){return null==t?"":(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(e,o){var t=data.getItemMetadata&&data.getItemMetadata(e),n=t&&t.columns&&(t.columns[o.id]||t.columns[getColumnIndex(o.id)]);return n&&n.formatter||t&&t.formatter||o.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(o)||options.defaultFormatter}function getEditor(e,o){var t=columns[o],n=data.getItemMetadata&&data.getItemMetadata(e),l=n&&n.columns;return l&&l[t.id]&&void 0!==l[t.id].editor?l[t.id].editor:l&&l[o]&&void 0!==l[o].editor?l[o].editor:t.editor||options.editorFactory&&options.editorFactory.getEditor(t)}function getDataItemValueForColumn(e,o){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(e,o):e[o.field]}function appendRowHtml(e,o,t,n,l){var r=getDataItem(t),i=t<l&&!r,a="slick-row"+(hasFrozenRows&&t<=options.frozenRow?" frozen":"")+(i?" loading":"")+(t===activeRow&&options.showCellSelection?" active":"")+(t%2==1?" odd":" even");r||(a+=" "+options.addNewRowCssClass);var s=data.getItemMetadata&&data.getItemMetadata(t);s&&s.cssClasses&&(a+=" "+s.cssClasses);var c,d,u=getFrozenRowOffset(t),h="<div class='ui-widget-content "+a+"' style='top:"+(getRowTop(t)-u)+"px'>";e.push(h),hasFrozenColumns()&&o.push(h);for(var p=0,f=columns.length;p<f;p++){if(d=columns[p],c=1,s&&s.columns){var m=s.columns[d.id]||s.columns[p];"*"===(c=m&&m.colspan||1)&&(c=f-p)}if(columnPosRight[Math.min(f-1,p+c-1)]>n.leftPx){if(!d.alwaysRenderColumn&&columnPosLeft[p]>n.rightPx)break;hasFrozenColumns()&&p>options.frozenColumn?appendCellHtml(o,t,p,c,r):appendCellHtml(e,t,p,c,r)}else(d.alwaysRenderColumn||hasFrozenColumns()&&p<=options.frozenColumn)&&appendCellHtml(e,t,p,c,r);c>1&&(p+=c-1)}e.push("</div>"),hasFrozenColumns()&&o.push("</div>")}function appendCellHtml(e,o,t,n,l){var r=columns[t],i="slick-cell l"+t+" r"+Math.min(columns.length-1,t+n-1)+(r.cssClass?" "+r.cssClass:"");for(var a in hasFrozenColumns()&&t<=options.frozenColumn&&(i+=" frozen"),o===activeRow&&t===activeCell&&options.showCellSelection&&(i+=" active"),cellCssClasses)cellCssClasses[a][o]&&cellCssClasses[a][o][r.id]&&(i+=" "+cellCssClasses[a][o][r.id]);var s=null,c="";l&&(s=getDataItemValueForColumn(l,r),null==(c=getFormatter(o,r)(o,t,s,r,l,self))&&(c=""));var d=trigger(self.onBeforeAppendCell,{row:o,cell:t,value:s,dataContext:l})||"";d+=c&&c.addClasses?(d?" ":"")+c.addClasses:"";var u=c&&c.toolTip?"title='"+c.toolTip+"'":"",h="";if(r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object)for(var a in r.cellAttrs)r.cellAttrs.hasOwnProperty(a)&&(h+=" "+a+'="'+r.cellAttrs[a]+'" ');e.push("<div class='"+i+(d?" "+d:"")+"' "+u+h+">"),l&&e.push("[object Object]"!==Object.prototype.toString.call(c)?c:c.text),e.push("</div>"),rowsCache[o].cellRenderQueue.push(t),rowsCache[o].cellColSpans[t]=n}function cleanupRows(e){for(var o in rowsCache){var t=!0;hasFrozenRows&&(options.frozenBottom&&o>=actualFrozenRow||!options.frozenBottom&&o<=actualFrozenRow)&&(t=!1),(o=parseInt(o,10))!==activeRow&&(o<e.top||o>e.bottom)&&t&&removeRowFromCache(o)}options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){for(var e in currentEditor&&makeActiveCellNormal(),rowsCache)removeRowFromCache(e);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(e,o,t){for(var n in postProcessgroupId++,o)o.hasOwnProperty(n)&&postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e.cellNodesByColumnIdx[0|n],columnIdx:0|n,rowIdx:t});postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:e.rowNode}),e.rowNode.detach()}function queuePostProcessedCellForCleanup(e,o,t){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e,columnIdx:o,rowIdx:t}),$(e).detach()}function removeRowFromCache(e){var o=rowsCache[e];o&&(options.enableAsyncPostRenderCleanup&&postProcessedRows[e]?queuePostProcessedRowForCleanup(o,postProcessedRows[e],e):o.rowNode.each((function(){this.parentElement&&this.parentElement.removeChild(this)})),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var o,t;if(e&&e.length){for(vScrollDir=0,t=e.length,o=0;o<t;o++)currentEditor&&activeRow===e[o]&&makeActiveCellNormal(),rowsCache[e[o]]&&removeRowFromCache(e[o]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(e){(e||0===e)&&invalidateRows([e])}function applyFormatResultToCellNode(e,o,t){null==e&&(e=""),"[object Object]"===Object.prototype.toString.call(e)?(o.innerHTML=sanitizeHtmlString(e.text),e.removeClasses&&!t&&$(o).removeClass(e.removeClasses),e.addClasses&&$(o).addClass(e.addClasses),e.toolTip&&$(o).attr("title",e.toolTip)):o.innerHTML=sanitizeHtmlString(e)}function updateCell(e,o){var t=getCellNode(e,o);if(t){var n=columns[o],l=getDataItem(e);if(currentEditor&&activeRow===e&&activeCell===o)currentEditor.loadValue(l);else applyFormatResultToCellNode(l?getFormatter(e,n)(e,o,getDataItemValueForColumn(l,n),n,l,self):"",t),invalidatePostProcessingResults(e)}}function updateRow(e){var o=rowsCache[e];if(o){ensureCellNodesInRowsCache(e);var t=getDataItem(e);for(var n in o.cellNodesByColumnIdx)if(o.cellNodesByColumnIdx.hasOwnProperty(n)){var l=columns[n|=0],r=o.cellNodesByColumnIdx[n][0];e===activeRow&&n===activeCell&&currentEditor?currentEditor.loadValue(t):t?applyFormatResultToCellNode(getFormatter(e,l)(e,n,getDataItemValueForColumn(t,l),l,t,self),r):r.innerHTML=""}invalidatePostProcessingResults(e)}}function getViewportHeight(){if(options.autoHeight&&-1==options.frozenColumn||(topPanelH=options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0,headerRowH=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,footerRowH=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0),options.autoHeight){var e=$paneHeaderL.outerHeight();e+=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0,e+=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0,e+=getCanvasWidth()>viewportW?scrollbarDimensions.height:0,viewportH=options.rowHeight*getDataLengthIncludingAddNew()+(-1==options.frozenColumn?e:0)}else{var o=options.showColumnHeader?parseFloat($.css($headerScroller[0],"height"))+getVBoxDelta($headerScroller):0,t=options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0;viewportH=parseFloat($.css($container[0],"height",!0))-parseFloat($.css($container[0],"paddingTop",!0))-parseFloat($.css($container[0],"paddingBottom",!0))-o-topPanelH-headerRowH-footerRowH-t}return numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportH}function getViewportWidth(){viewportW=parseFloat($container.width())}function resizeCanvas(){if(initialized){paneTopH=0,paneBottomH=0,viewportTopH=0,viewportBottomH=0,getViewportWidth(),getViewportHeight(),hasFrozenRows?options.frozenBottom?(paneTopH=viewportH-frozenRowsHeight-scrollbarDimensions.height,paneBottomH=frozenRowsHeight+scrollbarDimensions.height):(paneTopH=frozenRowsHeight,paneBottomH=viewportH-frozenRowsHeight):paneTopH=viewportH,paneTopH+=topPanelH+headerRowH+footerRowH,hasFrozenColumns()&&options.autoHeight&&(paneTopH+=scrollbarDimensions.height),viewportTopH=paneTopH-topPanelH-headerRowH-footerRowH,options.autoHeight&&(hasFrozenColumns()&&$container.height(paneTopH+parseFloat($.css($headerScrollerL[0],"height"))),$paneTopL.css("position","relative")),$paneTopL.css({top:$paneHeaderL.height()||(options.showHeaderRow?options.headerRowHeight:0)+(options.showPreHeaderPanel?options.preHeaderPanelHeight:0),height:paneTopH});var e=$paneTopL.position().top+paneTopH;options.autoHeight||$viewportTopL.height(viewportTopH),hasFrozenColumns()?($paneTopR.css({top:$paneHeaderL.height(),height:paneTopH}),$viewportTopR.height(viewportTopH),hasFrozenRows&&($paneBottomL.css({top:e,height:paneBottomH}),$paneBottomR.css({top:e,height:paneBottomH}),$viewportBottomR.height(paneBottomH))):hasFrozenRows&&($paneBottomL.css({width:"100%",height:paneBottomH}),$paneBottomL.css("top",e)),hasFrozenRows?($viewportBottomL.height(paneBottomH),options.frozenBottom?($canvasBottomL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasBottomR.height(frozenRowsHeight)):($canvasTopL.height(frozenRowsHeight),hasFrozenColumns()&&$canvasTopR.height(frozenRowsHeight))):$viewportTopR.height(viewportTopH),scrollbarDimensions&&scrollbarDimensions.width||(scrollbarDimensions=measureScrollbar()),options.autosizeColsMode===Slick.GridAutosizeColsMode.LegacyForceFit&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render()}}function updatePagingStatusFromView(e){pagingActive=0!==e.pageSize,pagingIsLastPage=e.pageNum==e.totalPages-1}function updateRowCount(){if(initialized){var e=getDataLength(),o=getDataLengthIncludingAddNew(),t=0,l=hasFrozenRows&&!options.frozenBottom?$canvasBottomL.height():$canvasTopL.height();if(hasFrozenRows)t=getDataLength()-options.frozenRow;else t=o+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var r=$viewportScrollContainerY.height(),i=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&t*options.rowHeight>r,makeActiveCellNormal();var a=e-1;for(var s in rowsCache)s>a&&removeRowFromCache(s);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>a&&resetActiveCell();l=h;options.autoHeight?h=options.rowHeight*t:(th=Math.max(options.rowHeight*t,r-scrollbarDimensions.height))<maxSupportedCssHeight?(h=ph=th,n=1,cj=0):(ph=(h=maxSupportedCssHeight)/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==l&&(hasFrozenRows&&!options.frozenBottom?($canvasBottomL.css("height",h),hasFrozenColumns()&&$canvasBottomR.css("height",h)):($canvasTopL.css("height",h),$canvasTopR.css("height",h)),scrollTop=$viewportScrollContainerY[0].scrollTop);var c=scrollTop+offset<=th-r;0==th||0==scrollTop?page=offset=0:scrollTo(c?scrollTop+offset:th-r+scrollbarDimensions.height),h!=l&&options.autoHeight&&resizeCanvas(),options.autosizeColsMode===Slick.GridAutosizeColsMode.LegacyForceFit&&i!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(e,o){return null==e&&(e=scrollTop),null==o&&(o=scrollLeft),{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:o,rightPx:o+viewportW}}function getRenderedRange(e,o){var t=getVisibleRange(e,o),n=Math.round(viewportH/options.rowHeight),l=options.minRowBuffer;return-1==vScrollDir?(t.top-=n,t.bottom+=l):1==vScrollDir?(t.top-=l,t.bottom+=n):(t.top-=l,t.bottom+=l),t.top=Math.max(0,t.top),t.bottom=Math.min(getDataLengthIncludingAddNew()-1,t.bottom),t.leftPx-=viewportW,t.rightPx+=viewportW,t.leftPx=Math.max(0,t.leftPx),t.rightPx=Math.min(canvasWidth,t.rightPx),t}function ensureCellNodesInRowsCache(e){var o=rowsCache[e];if(o&&o.cellRenderQueue.length)for(var t=o.rowNode.children().last();o.cellRenderQueue.length;){var n=o.cellRenderQueue.pop();o.cellNodesByColumnIdx[n]=t,0===(t=t.prev()).length&&(t=$(o.rowNode[0]).children().last())}}function cleanUpCells(e,o){if(!hasFrozenRows||!(options.frozenBottom&&o>actualFrozenRow||o<=actualFrozenRow)){var t,n,l=rowsCache[o],r=[];for(var i in l.cellNodesByColumnIdx)if(l.cellNodesByColumnIdx.hasOwnProperty(i)&&!((i|=0)<=options.frozenColumn||Array.isArray(columns)&&columns[i]&&columns[i].alwaysRenderColumn)){var a=l.cellColSpans[i];(columnPosLeft[i]>e.rightPx||columnPosRight[Math.min(columns.length-1,i+a-1)]<e.leftPx)&&(o==activeRow&&i==activeCell||r.push(i))}for(;null!=(t=r.pop());)n=l.cellNodesByColumnIdx[t][0],options.enableAsyncPostRenderCleanup&&postProcessedRows[o]&&postProcessedRows[o][t]?queuePostProcessedCellForCleanup(n,t,o):n.parentElement.removeChild(n),delete l.cellColSpans[t],delete l.cellNodesByColumnIdx[t],postProcessedRows[o]&&delete postProcessedRows[o][t]}}function cleanUpAndRenderCells(e){for(var o,t,n,l=[],r=[],i=e.top,a=e.bottom;i<=a;i++)if(o=rowsCache[i]){ensureCellNodesInRowsCache(i),cleanUpCells(e,i),t=0;var s=data.getItemMetadata&&data.getItemMetadata(i);s=s&&s.columns;for(var c=getDataItem(i),d=0,u=columns.length;d<u&&!(columnPosLeft[d]>e.rightPx);d++)if(null==(n=o.cellColSpans[d])){if(n=1,s){var h=s[columns[d].id]||s[d];"*"===(n=h&&h.colspan||1)&&(n=u-d)}columnPosRight[Math.min(u-1,d+n-1)]>e.leftPx&&(appendCellHtml(l,i,d,n,c),t++),d+=n>1?n-1:0}else d+=n>1?n-1:0;t&&(t,r.push(i))}if(l.length){var p,f,m=document.createElement("div");for(m.innerHTML=sanitizeHtmlString(l.join(""));null!=(p=r.pop());){var g;for(o=rowsCache[p];null!=(g=o.cellRenderQueue.pop());)f=m.lastChild,hasFrozenColumns()&&g>options.frozenColumn?o.rowNode[1].appendChild(f):o.rowNode[0].appendChild(f),o.cellNodesByColumnIdx[g]=$(f)}}}function renderRows(e){for(var o=[],t=[],n=[],l=!1,r=getDataLength(),i=e.top,a=e.bottom;i<=a;i++)rowsCache[i]||hasFrozenRows&&options.frozenBottom&&i==getDataLength()||(renderedRows++,n.push(i),rowsCache[i]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(o,t,i,e,r),activeCellNode&&activeRow===i&&(l=!0),counter_rows_rendered++);if(n.length){var s=document.createElement("div"),c=document.createElement("div");s.innerHTML=sanitizeHtmlString(o.join("")),c.innerHTML=sanitizeHtmlString(t.join(""));for(i=0,a=n.length;i<a;i++)hasFrozenRows&&n[i]>=actualFrozenRow?hasFrozenColumns()?(rowsCache[n[i]].rowNode=$().add($(s.firstChild)).add($(c.firstChild)),$canvasBottomL[0].appendChild(s.firstChild),$canvasBottomR[0].appendChild(c.firstChild)):(rowsCache[n[i]].rowNode=$().add($(s.firstChild)),$canvasBottomL[0].appendChild(s.firstChild)):hasFrozenColumns()?(rowsCache[n[i]].rowNode=$().add($(s.firstChild)).add($(c.firstChild)),$canvasTopL[0].appendChild(s.firstChild),$canvasTopR[0].appendChild(c.firstChild)):(rowsCache[n[i]].rowNode=$().add($(s.firstChild)),$canvasTopL[0].appendChild(s.firstChild));l&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(e){for(var o in postProcessedRows[e])postProcessedRows[e].hasOwnProperty(o)&&(postProcessedRows[e][o]="C");postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache){var o=e?parseInt(e):0;rowsCache[o].rowNode[0].style.top=getRowTop(o)+"px"}}function render(){if(initialized){scrollThrottle.dequeue();var e=getVisibleRange(),o=getRenderedRange();if(cleanupRows(o),lastRenderedScrollLeft!=scrollLeft){if(hasFrozenRows){var t=jQuery.extend(!0,{},o);options.frozenBottom?(t.top=actualFrozenRow,t.bottom=getDataLength()):(t.top=0,t.bottom=options.frozenRow),cleanUpAndRenderCells(t)}cleanUpAndRenderCells(o)}renderRows(o),hasFrozenRows&&(options.frozenBottom?renderRows({top:actualFrozenRow,bottom:getDataLength()-1,leftPx:o.leftPx,rightPx:o.rightPx}):renderRows({top:0,bottom:options.frozenRow-1,leftPx:o.leftPx,rightPx:o.rightPx})),postProcessFromRow=e.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null,trigger(self.onRendered,{startRow:e.top,endRow:e.bottom,grid:self})}}function handleHeaderScroll(){handleElementScroll($headerScrollContainer[0])}function handleHeaderRowScroll(){var e=$headerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handleFooterRowScroll(){var e=$footerRowScrollContainer[0].scrollLeft;e!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=e)}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(e){var o=e.scrollLeft;o!=$viewportScrollContainerX[0].scrollLeft&&($viewportScrollContainerX[0].scrollLeft=o)}function handleScroll(){return scrollTop=$viewportScrollContainerY[0].scrollTop,scrollLeft=$viewportScrollContainerX[0].scrollLeft,_handleScroll(!1)}function _handleScroll(e){var o=$viewportScrollContainerY[0].scrollHeight-$viewportScrollContainerY[0].clientHeight,t=$viewportScrollContainerY[0].scrollWidth-$viewportScrollContainerY[0].clientWidth;o=Math.max(0,o),t=Math.max(0,t),scrollTop>o&&(scrollTop=o),scrollLeft>t&&(scrollLeft=t);var l=Math.abs(scrollTop-prevScrollTop),r=Math.abs(scrollLeft-prevScrollLeft);if(r&&(prevScrollLeft=scrollLeft,$viewportScrollContainerX[0].scrollLeft=scrollLeft,$headerScrollContainer[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScrollContainer[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScrollContainer[0].scrollLeft=scrollLeft),options.createPreHeaderPanel&&(hasFrozenColumns()?$preHeaderPanelScrollerR[0].scrollLeft=scrollLeft:$preHeaderPanelScroller[0].scrollLeft=scrollLeft),hasFrozenColumns()?hasFrozenRows&&($viewportTopR[0].scrollLeft=scrollLeft):hasFrozenRows&&($viewportTopL[0].scrollLeft=scrollLeft)),l&&!options.autoHeight)if(vScrollDir=prevScrollTop<scrollTop?1:-1,prevScrollTop=scrollTop,e&&($viewportScrollContainerY[0].scrollTop=scrollTop),hasFrozenColumns()&&(hasFrozenRows&&!options.frozenBottom?$viewportBottomL[0].scrollTop=scrollTop:$viewportTopL[0].scrollTop=scrollTop),l<viewportH)scrollTo(scrollTop+offset);else{var i=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),i!=(offset=Math.round(page*cj))&&invalidateAllRows()}if(r||l){var a=Math.abs(lastRenderedScrollLeft-scrollLeft),s=Math.abs(lastRenderedScrollTop-scrollTop);(a>20||s>20)&&(options.forceSyncScrolling||s<viewportH&&a<viewportW?render():scrollThrottle.enqueue(),trigger(self.onViewportChanged,{}))}return trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop}),!(!r&&!l)}function ActionThrottle(e,o){var t=!1,n=!1;function l(){n=!1}function r(){t=!0,setTimeout(i,o),e()}function i(){n?(l(),r()):t=!1}return{enqueue:function(){t?n=!0:r()},dequeue:l}}function asyncPostProcessRows(){for(var e=getDataLength();postProcessFromRow<=postProcessToRow;){var o=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,t=rowsCache[o];if(t&&!(o>=e)){for(var n in postProcessedRows[o]||(postProcessedRows[o]={}),ensureCellNodesInRowsCache(o),t.cellNodesByColumnIdx)if(t.cellNodesByColumnIdx.hasOwnProperty(n)){var l=columns[n|=0],r=postProcessedRows[o][n];if(l.asyncPostRender&&"R"!==r){var i=t.cellNodesByColumnIdx[n];i&&l.asyncPostRender(i,o,getDataItem(o),l,"C"===r),postProcessedRows[o][n]="R"}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var e=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==e;){var o=postProcessedCleanupQueue.shift();if("R"==o.actionType&&$(o.node).remove(),"C"==o.actionType){var t=columns[o.columnIdx];t.asyncPostRenderCleanup&&o.node&&t.asyncPostRenderCleanup(o.node,o.rowIdx,t)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(e,o){var t,n,l,r;for(var i in rowsCache){if(r=o&&o[i],l=e&&e[i],r)for(n in r)l&&r[n]==l[n]||(t=getCellNode(i,getColumnIndex(n)))&&$(t).removeClass(r[n]);if(l)for(n in l)r&&r[n]==l[n]||(t=getCellNode(i,getColumnIndex(n)))&&$(t).addClass(l[n])}}function addCellCssStyles(e,o){if(cellCssClasses[e])throw new Error("SlickGrid addCellCssStyles: cell CSS hash with key '"+e+"' already exists.");cellCssClasses[e]=o,updateCellCssStylesOnRenderedRows(o,null),trigger(self.onCellCssStylesChanged,{key:e,hash:o,grid:self})}function removeCellCssStyles(e){cellCssClasses[e]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]),delete cellCssClasses[e],trigger(self.onCellCssStylesChanged,{key:e,hash:null,grid:self}))}function setCellCssStyles(e,o){var t=cellCssClasses[e];cellCssClasses[e]=o,updateCellCssStylesOnRenderedRows(o,t),trigger(self.onCellCssStylesChanged,{key:e,hash:o,grid:self})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,o,t){(t=t||100,rowsCache[e])&&function e(o,n){n&&setTimeout((function(){o.queue((function(){o.toggleClass(options.cellFlashingCssClass).dequeue(),e(o,n-1)}))}),t)}($(getCellNode(e,o)),4)}function handleMouseWheel(e,o,t,n){scrollTop=Math.max(0,$viewportScrollContainerY[0].scrollTop-n*options.rowHeight),scrollLeft=$viewportScrollContainerX[0].scrollLeft+10*t,_handleScroll(!0)&&e.preventDefault()}function convertToJQueryEvent(e){return Object.defineProperty(e,"isImmediatePropagationStopped",{writable:!0,value:function(){return!!e.defaultPrevented}}),Object.defineProperty(e,"isPropagationStopped",{writable:!0,value:function(){return!!e.defaultPrevented}}),e}function handleDragInit(e,o){var t=getCellFromEvent(e="function"==typeof e.isImmediatePropagationStopped?e:convertToJQueryEvent(e));if(!t||!cellExists(t.row,t.cell))return!1;var n=trigger(self.onDragInit,o,e);return!!e.isImmediatePropagationStopped()&&n}function handleDragStart(e,o){var t=getCellFromEvent(e="function"==typeof e.isImmediatePropagationStopped?e:convertToJQueryEvent(e));if(!t||!cellExists(t.row,t.cell))return!1;var n=trigger(self.onDragStart,o,e);return!!e.isImmediatePropagationStopped()&&n}function handleDrag(e,o){return e="function"==typeof e.isImmediatePropagationStopped?e:convertToJQueryEvent(e),trigger(self.onDrag,o,e)}function handleDragEnd(e,o){e="function"==typeof e.isImmediatePropagationStopped?e:convertToJQueryEvent(e),trigger(self.onDragEnd,o,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var o=e.isImmediatePropagationStopped(),t=Slick.keyCode;if(!o&&!e.shiftKey&&!e.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.which==t.HOME?o=e.ctrlKey?navigateTop():navigateRowStart():e.which==t.END&&(o=e.ctrlKey?navigateBottom():navigateRowEnd())}if(!o)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=t.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(o=navigatePrev());else{if(options.editable&&currentEditor&&currentEditor.keyCaptureList&&currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which==t.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else e.which==t.PAGE_DOWN?(navigatePageDown(),o=!0):e.which==t.PAGE_UP?(navigatePageUp(),o=!0):e.which==t.LEFT?o=navigateLeft():e.which==t.RIGHT?o=navigateRight():e.which==t.UP?o=navigateUp():e.which==t.DOWN?o=navigateDown():e.which==t.TAB?o=navigateNext():e.which==t.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable(void 0,void 0,e)),o=!0)}if(o){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}function handleClick(e){if(!currentEditor&&(e.target!=document.activeElement||$(e.target).hasClass("slick-cell"))){var o=getTextSelection();setFocus(),setTextSelection(o)}var t=getCellFromEvent(e);if(t&&(null===currentEditor||activeRow!=t.row||activeCell!=t.cell)&&(trigger(self.onClick,{row:t.row,cell:t.cell},e),!e.isImmediatePropagationStopped()&&canCellBeActive(t.row,t.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()))){scrollRowIntoView(t.row,!1);var n=e.target&&e.target.className===Slick.preClickClassName,l=columns[t.cell],r=!!(options.editable&&l&&l.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(t.row,t.cell),null,n,r,e)}}function handleContextMenu(e){var o=$(e.target).closest(".slick-cell",$canvas);0!==o.length&&(activeCellNode===o[0]&&null!==currentEditor||trigger(self.onContextMenu,{},e))}function handleDblClick(e){var o=getCellFromEvent(e);!o||null!==currentEditor&&activeRow==o.row&&activeCell==o.cell||(trigger(self.onDblClick,{row:o.row,cell:o.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(o.row,o.cell,!0,e))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data("column"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data("column"),grid:self},e)}function handleHeaderRowMouseEnter(e){trigger(self.onHeaderRowMouseEnter,{column:$(this).data("column"),grid:self},e)}function handleHeaderRowMouseLeave(e){trigger(self.onHeaderRowMouseLeave,{column:$(this).data("column"),grid:self},e)}function handleHeaderContextMenu(e){var o=$(e.target).closest(".slick-header-column",".slick-header-columns"),t=o&&o.data("column");trigger(self.onHeaderContextMenu,{column:t},e)}function handleHeaderClick(e){if(!columnResizeDragging){var o=$(e.target).closest(".slick-header-column",".slick-header-columns"),t=o&&o.data("column");t&&trigger(self.onHeaderClick,{column:t},e)}}function handleFooterContextMenu(e){var o=$(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),t=o&&o.data("column");trigger(self.onFooterContextMenu,{column:t},e)}function handleFooterClick(e){var o=$(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns"),t=o&&o.data("column");trigger(self.onFooterClick,{column:t},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,o){return!(e<0||e>=getDataLength()||o<0||o>=columns.length)}function getCellFromPoint(e,o){for(var t=getRowFromPosition(o),n=0,l=0,r=0;r<columns.length&&l<e;r++)l+=columns[r].width,n++;return n<0&&(n=0),{row:t,cell:n-1}}function getCellFromNode(e){var o=/l\d+/.exec(e.className);if(!o)throw new Error("SlickGrid getCellFromNode: cannot get cell - "+e.className);return parseInt(o[0].substr(1,o[0].length-1),10)}function getRowFromNode(e){for(var o in rowsCache)for(var t in rowsCache[o].rowNode)if(rowsCache[o].rowNode[t]===e)return o?parseInt(o):0;return null}function getFrozenRowOffset(e){return hasFrozenRows?options.frozenBottom?e>=actualFrozenRow?h<viewportTopH?actualFrozenRow*options.rowHeight:h:0:e>=actualFrozenRow?frozenRowsHeight:0:0}function getCellFromEvent(e){var o,t,n=e.touches?e.touches[0]:e,l=$(e.target).closest(".slick-cell",$canvas);if(!l.length)return null;if(o=getRowFromNode(l[0].parentNode),hasFrozenRows){var r=l.parents(".grid-canvas").offset(),i=0;l.parents(".grid-canvas-bottom").length&&(i=options.frozenBottom?$canvasTopL.height():frozenRowsHeight),o=getCellFromPoint(n.clientX-r.left,n.clientY-r.top+i+$(document).scrollTop()).row}return t=getCellFromNode(l[0]),null==o||null==t?null:{row:o,cell:t}}function getCellNodeBox(e,o){if(!cellExists(e,o))return null;for(var t=getFrozenRowOffset(e),n=getRowTop(e)-t,l=n+options.rowHeight-1,r=0,i=0;i<o;i++)r+=columns[i].width,options.frozenColumn==i&&(r=0);return{top:n,left:r,bottom:l,right:r+columns[o].width}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(e,o,t){if(scrollRowIntoView(e,t),!(o<=options.frozenColumn)){var n=getColspan(e,o);internalScrollColumnIntoView(columnPosLeft[o],columnPosRight[o+(n>1?n-1:0)])}}function internalScrollColumnIntoView(e,o){var t=scrollLeft+$viewportScrollContainerX.width()-(viewportHasVScroll?scrollbarDimensions.width:0);e<scrollLeft?($viewportScrollContainerX.scrollLeft(e),handleScroll(),render()):o>t&&($viewportScrollContainerX.scrollLeft(Math.min(e,o-$viewportScrollContainerX[0].clientWidth)),handleScroll(),render())}function scrollColumnIntoView(e){internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e])}function setActiveCellInternal(e,o,t,n,l){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"),rowsCache[activeRow]&&rowsCache[activeRow].rowNode.removeClass("active"));if(null!=(activeCellNode=e)){var r=$(activeCellNode),i=r.offset(),a=Math.floor(r.parents(".grid-canvas").offset().top),s=r.parents(".grid-canvas-bottom").length;hasFrozenRows&&s&&(a-=options.frozenBottom?$canvasTopL.height():frozenRowsHeight);var c=getCellFromPoint(i.left,Math.ceil(i.top)-a);activeRow=c.row,activeCell=activePosX=activeCell=activePosX=getCellFromNode(activeCellNode),null==o&&(o=activeRow==getDataLength()||options.autoEdit),options.showCellSelection&&(r.addClass("active"),rowsCache[activeRow]&&rowsCache[activeRow].rowNode.addClass("active")),options.editable&&o&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout((function(){makeActiveCellEditable(void 0,t,l)}),options.asyncEditorLoadDelay):makeActiveCellEditable(void 0,t,l))}else activeRow=activeCell=null;n||trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function isCellPotentiallyEditable(e,o){var t=getDataLength();return!(e<t&&!getDataItem(e))&&(!(columns[o].cannotTriggerInsert&&e>=t)&&!!getEditor(e,o))}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var e=getDataItem(activeRow);if($(activeCellNode).removeClass("editable invalid"),e){var o=columns[activeCell];applyFormatResultToCellNode(getFormatter(activeRow,o)(activeRow,activeCell,getDataItemValueForColumn(e,o),o,e,self),activeCellNode),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e,o,t){if(activeCellNode){if(!options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when options.editable is false");if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var n=columns[activeCell],l=getDataItem(activeRow);if(!1!==trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:l,column:n,target:"grid"})){getEditorLock().activate(editController),$(activeCellNode).addClass("editable");var r=e||getEditor(activeRow,activeCell);e||r.suppressClearOnEdit||(activeCellNode.innerHTML="");var i=data.getItemMetadata&&data.getItemMetadata(activeRow),a=(i=i&&i.columns)&&(i[n.id]||i[activeCell]);currentEditor=new r({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:n,columnMetaData:a,item:l||{},event:t,commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),l&&(currentEditor.loadValue(l),o&&currentEditor.preClick&&currentEditor.preClick()),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}else setFocus()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var o={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$(e).outerWidth(),height:$(e).outerHeight(),visible:!0};o.bottom=o.top+o.height,o.right=o.left+o.width;for(var t=e.offsetParent;(e=e.parentNode)!=document.body&&null!=e;)o.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=$(e).css("overflowY")&&(o.visible=o.bottom>e.scrollTop&&o.top<e.scrollTop+e.clientHeight),o.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=$(e).css("overflowX")&&(o.visible=o.right>e.scrollLeft&&o.left<e.scrollLeft+e.clientWidth),o.left-=e.scrollLeft,o.top-=e.scrollTop,e===t&&(o.left+=e.offsetLeft,o.top+=e.offsetTop,t=e.offsetParent),o.bottom=o.top+o.height,o.right=o.left+o.width;return o}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var e=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function getTextSelection(){var e=null;if(window.getSelection){var o=window.getSelection();o.rangeCount>0&&(e=o.getRangeAt(0))}return e}function setTextSelection(e){if(window.getSelection&&e){var o=window.getSelection();o.removeAllRanges(),o.addRange(e)}}function scrollRowIntoView(e,o){if(!hasFrozenRows||!options.frozenBottom&&e>actualFrozenRow-1||options.frozenBottom&&e<actualFrozenRow-1){var t=$viewportScrollContainerY.height(),n=hasFrozenRows&&!options.frozenBottom?e-options.frozenRow:e,l=n*options.rowHeight,r=(n+1)*options.rowHeight-t+(viewportHasHScroll?scrollbarDimensions.height:0);(n+1)*options.rowHeight>scrollTop+t+offset?(scrollTo(o?l:r),render()):n*options.rowHeight<scrollTop+offset&&(scrollTo(o?r:l),render())}}function scrollRowToTop(e){scrollTo(e*options.rowHeight),render()}function scrollPage(e){var o=e*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop+options.rowHeight-1)+o)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var t=activeRow+o,n=getDataLengthIncludingAddNew();t>=n&&(t=n-1),t<0&&(t=0);for(var l=0,r=null,i=activePosX;l<=activePosX;)canCellBeActive(t,l)&&(r=l),l+=getColspan(t,l);null!==r?(setActiveCellInternal(getCellNode(t,r)),activePosX=i):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(e){var o=getDataLength();if(!o)return!0;if(e<0?e=0:e>=o&&(e=o-1),scrollCellIntoView(e,0,!0),options.enableCellNavigation&&null!=activeRow){for(var t=0,n=null,l=activePosX;t<=activePosX;)canCellBeActive(e,t)&&(n=t),t+=getColspan(e,t);null!==n?(setActiveCellInternal(getCellNode(e,n)),activePosX=l):resetActiveCell()}return!0}function getColspan(e,o){var t=data.getItemMetadata&&data.getItemMetadata(e);if(!t||!t.columns)return 1;var n=t.columns[columns[o].id]||t.columns[o],l=n&&n.colspan;return l="*"===l?columns.length-o:l||1}function findFirstFocusableCell(e){for(var o=0;o<columns.length;){if(canCellBeActive(e,o))return o;o+=getColspan(e,o)}return null}function findLastFocusableCell(e){for(var o=0,t=null;o<columns.length;)canCellBeActive(e,o)&&(t=o),o+=getColspan(e,o);return t}function gotoRight(e,o,t){if(o>=columns.length)return null;do{o+=getColspan(e,o)}while(o<columns.length&&!canCellBeActive(e,o));return o<columns.length?{row:e,cell:o,posX:o}:null}function gotoLeft(e,o,t){if(o<=0)return null;var n=findFirstFocusableCell(e);if(null===n||n>=o)return null;for(var l,r={row:e,cell:n,posX:n};;){if(!(l=gotoRight(r.row,r.cell,r.posX)))return null;if(l.cell>=o)return r;r=l}}function gotoDown(e,o,t){for(var n,l=getDataLengthIncludingAddNew();;){if(++e>=l)return null;for(n=o=0;o<=t;)n=o,o+=getColspan(e,o);if(canCellBeActive(e,n))return{row:e,cell:n,posX:t}}}function gotoUp(e,o,t){for(var n;;){if(--e<0)return null;for(n=o=0;o<=t;)n=o,o+=getColspan(e,o);if(canCellBeActive(e,n))return{row:e,cell:n,posX:t}}}function gotoNext(e,o,t){if(null==e&&null==o&&canCellBeActive(e=o=t=0,o))return{row:e,cell:o,posX:o};var n=gotoRight(e,o,t);if(n)return n;var l=null,r=getDataLengthIncludingAddNew();for(e===r-1&&e--;++e<r;)if(null!==(l=findFirstFocusableCell(e)))return{row:e,cell:l,posX:l};return null}function gotoPrev(e,o,t){if(null==e&&null==o&&canCellBeActive(e=getDataLengthIncludingAddNew()-1,o=t=columns.length-1))return{row:e,cell:o,posX:o};for(var n,l;!n&&!(n=gotoLeft(e,o,t));){if(--e<0)return null;o=0,null!==(l=findLastFocusableCell(e))&&(n={row:e,cell:l,posX:l})}return n}function gotoRowStart(e,o,t){var n=findFirstFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}function gotoRowEnd(e,o,t){var n=findLastFocusableCell(e);return null===n?null:{row:e,cell:n,posX:n}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(e){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=e&&"next"!=e)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus();tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];var o=(0,{up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd}[e])(activeRow,activeCell,activePosX);if(o){if(hasFrozenRows&&options.frozenBottom&o.row==getDataLength())return;var t=o.row==getDataLength();return(!options.frozenBottom&&o.row>=actualFrozenRow||options.frozenBottom&&o.row<actualFrozenRow)&&scrollCellIntoView(o.row,o.cell,!t&&options.emulatePagingWhenScrolling),setActiveCellInternal(getCellNode(o.row,o.cell)),activePosX=o.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(e,o){if(rowsCache[e]){ensureCellNodesInRowsCache(e);try{return rowsCache[e].cellNodesByColumnIdx.length>o?rowsCache[e].cellNodesByColumnIdx[o][0]:null}catch(t){return rowsCache[e].cellNodesByColumnIdx[o]}}return null}function setActiveCell(e,o,t,n,l){initialized&&(e>getDataLength()||e<0||o>=columns.length||o<0||options.enableCellNavigation&&(scrollCellIntoView(e,o,!1),setActiveCellInternal(getCellNode(e,o),t,n,l)))}function setActiveRow(e,o,t){initialized&&(e>getDataLength()||e<0||o>=columns.length||o<0||(activeRow=e,t||scrollCellIntoView(e,o||0,!1)))}function canCellBeActive(e,o){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||e<0||o>=columns.length||o<0)return!1;var t=data.getItemMetadata&&data.getItemMetadata(e);if(t&&void 0!==t.focusable)return!!t.focusable;var n=t&&t.columns;return n&&n[columns[o].id]&&void 0!==n[columns[o].id].focusable?!!n[columns[o].id].focusable:n&&n[o]&&void 0!==n[o].focusable?!!n[o].focusable:!!columns[o].focusable}function canCellBeSelected(e,o){if(e>=getDataLength()||e<0||o>=columns.length||o<0)return!1;var t=data.getItemMetadata&&data.getItemMetadata(e);if(t&&void 0!==t.selectable)return!!t.selectable;var n=t&&t.columns&&(t.columns[columns[o].id]||t.columns[o]);return n&&void 0!==n.selectable?!!n.selectable:!!columns[o].selectable}function gotoCell(e,o,t,n){if(initialized&&canCellBeActive(e,o)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(e,o,!1);var l=getCellNode(e,o),r=columns[o],i=!!(options.editable&&r&&r.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(l,t||e===getDataLength()||options.autoEdit,null,i,n),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),o=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var t=currentEditor.validate();if(t.valid){if(activeRow<getDataLength()){var n={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{command:"execute",row:this.row,cell:this.cell,item:e,column:o})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{command:"undo",row:this.row,cell:this.cell,item:e,column:o})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,o,n)):(n.execute(),makeActiveCellNormal())}else{var l={};currentEditor.applyValue(l,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:l,column:o})}return!getEditorLock().isActive()}return $(activeCellNode).removeClass("invalid"),$(activeCellNode).width(),$(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:t,row:activeRow,cell:activeCell,column:o}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var o=[],t=columns.length-1,n=0;n<e.length;n++)o.push(new Slick.Range(e[n],0,e[n],t));return o}function getSelectedRows(){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");return selectedRows.slice(0)}function setSelectedRows(e,o){if(!selectionModel)throw new Error("SlickGrid Selection model is not set");self&&self.getEditorLock&&!self.getEditorLock().isActive()&&selectionModel.setSelectedRanges(rowsToRanges(e),o||"SlickGrid.setSelectedRows")}var logMessageCount=0,logMessageMaxCount=30;function sanitizeHtmlString(e,o){if(!options.sanitizer||"string"!=typeof e)return e;var t=options.sanitizer(e);return!o&&options.logSanitizedHtml&&logMessageCount<=logMessageMaxCount&&t!==e&&(console.log("sanitizer altered html: "+e+" --\x3e "+t),logMessageCount===logMessageMaxCount&&console.log("sanitizer: silencing messages after first "+logMessageMaxCount),logMessageCount++),t}this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+counter_rows_rendered,e+="\ncounter_rows_removed:  "+counter_rows_removed,e+="\nrenderedRows:  "+renderedRows,e+="\nnumVisibleRows:  "+numVisibleRows,e+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,e+="\nn(umber of pages):  "+n,e+="\n(current) page:  "+page,e+="\npage height (ph):  "+ph,e+="\nvScrollDir:  "+vScrollDir,alert(e)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.4.45",onScroll:new Slick.Event,onBeforeSort:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderRowMouseEnter:new Slick.Event,onHeaderRowMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onFooterContextMenu:new Slick.Event,onFooterClick:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onBeforeAppendCell:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsDrag:new Slick.Event,onColumnsResized:new Slick.Event,onColumnsResizeDblClick:new Slick.Event,onBeforeColumnsResize:new Slick.Event,onCellChange:new Slick.Event,onCompositeEditorChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,onAutosizeColumns:new Slick.Event,onBeforeSetColumns:new Slick.Event,onRendered:new Slick.Event,onSetOptions:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getPluginByName:getPluginByName,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,autosizeColumn:autosizeColumn,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,updatePagingStatusFromView:updatePagingStatusFromView,applyFormatResultToCellNode:applyFormatResultToCellNode,render:render,reRenderColumns:reRenderColumns,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,scrollColumnIntoView:scrollColumnIntoView,getCanvasNode:getCanvasNode,getUID:getUID,getHeaderColumnWidthDiff:getHeaderColumnWidthDiff,getScrollbarDimensions:getScrollbarDimensions,getHeadersWidth:getHeadersWidth,getCanvasWidth:getCanvasWidth,getCanvases:getCanvases,getActiveCanvasNode:getActiveCanvasNode,setActiveCanvasNode:setActiveCanvasNode,getViewportNode:getViewportNode,getViewports:getViewports,getActiveViewportNode:getActiveViewportNode,setActiveViewportNode:setActiveViewportNode,focus:setFocus,scrollTo:scrollTo,cacheCssForHiddenInit:cacheCssForHiddenInit,restoreCssFromHiddenInit:restoreCssFromHiddenInit,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,setActiveRow:setActiveRow,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,navigateTop:navigateTop,navigateBottom:navigateBottom,navigateRowStart:navigateRowStart,navigateRowEnd:navigateRowEnd,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,getPreHeaderPanel:getPreHeaderPanel,getPreHeaderPanelLeft:getPreHeaderPanel,getPreHeaderPanelRight:getPreHeaderPanelRight,setPreHeaderPanelVisibility:setPreHeaderPanelVisibility,getHeader:getHeader,getHeaderColumn:getHeaderColumn,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,setFooterRowVisibility:setFooterRowVisibility,getFooterRow:getFooterRow,getFooterRowColumn:getFooterRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,getFrozenRowOffset:getFrozenRowOffset,setColumnHeaderVisibility:setColumnHeaderVisibility,sanitizeHtmlString:sanitizeHtmlString,getDisplayedScrollbarDimensions:getDisplayedScrollbarDimensions,getAbsoluteColumnMinWidth:getAbsoluteColumnMinWidth,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}})})(jQuery);